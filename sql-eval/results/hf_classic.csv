question,query,db_name,query_category,instructions,db_type,generated_query,reason,error_msg,exact_match,correct,error_query_gen,error_db_exec,timeout,latency_seconds,tokens_used,k_shot_prompt,glossary,table_metadata_string,prev_invalid_sql,prev_error_msg,question_0,query_0,question_1,query_1,cot_instructions,cot_pregen
How many publications were published between 2019 and 2021?,SELECT count(DISTINCT publication.pid) FROM publication WHERE publication.year BETWEEN 2019 AND 2021;,academic,date_functions,,postgres,"SELECT count(*) FROM publication
WHERE publication.year BETWEEN 2019 AND 2021;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average number of citations received by publications in the last 5 years?,SELECT avg(publication.citation_num) FROM publication WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 5;,academic,date_functions,,postgres,SELECT avg(publication.citation_num) FROM publication WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 5;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What's the difference in time between the first and last paper published?,SELECT max(YEAR) - min(YEAR) AS time_difference FROM publication;,academic,date_functions,,postgres,SELECT max(YEAR) - min(YEAR) AS time_difference FROM publication;,,,1,1,0,0,0,,0,,,,,,,,,,,False
Which authors have published papers in journals within the past 20 years?,"SELECT DISTINCT {author.name, author.aid} FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 20;",academic,date_functions,,postgres,SELECT DISTINCT a.name FROM author AS a JOIN writes AS w ON a.aid  =  w.aid JOIN publication AS p ON w.pid  =  p.pid JOIN journal AS j ON p.jid  =  j.jid WHERE p.year  <  2019;,,,0,0,0,0,0,,0,,,,,,,,,,,False
Which conference published the most publications in the last 15 years? Give the conference name and publication count.,"SELECT conference.name, count(publication.pid) AS publication_count FROM publication JOIN conference ON publication.cid = conference.cid WHERE publication.year >= extract(YEAR FROM CURRENT_DATE) - 15 GROUP BY conference.name ORDER BY publication_count DESC LIMIT 1;",academic,date_functions,,postgres,"SELECT c.name, count(*) FROM conference AS c
JOIN domain_conference AS dc ON c.cid  =  dc.cid
JOIN publication AS p ON dc.did  =  p.did
WHERE p.year >= extract(YEAR FROM CURRENT_DATE) - 15
GROUP BY c.name
ORDER BY count(*) DESC
LIMIT 1;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column p.did does not exist
LINE 3: JOIN publication AS p ON dc.did  =  p.did
                                            ^

[SQL: SELECT c.name, count(*) FROM conference AS c
JOIN domain_conference AS dc ON c.cid  =  dc.cid
JOIN publication AS p ON dc.did  =  p.did
WHERE p.year >= extract(YEAR FROM CURRENT_DATE) - 15
GROUP BY c.name
ORDER BY count(*) DESC
LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the average number of citations received by publications in each year?,"SELECT publication.year, AVG(publication.citation_num) AS average_citations FROM publication GROUP BY publication.year ORDER BY publication.year NULLS LAST;",academic,group_by,,postgres,"SELECT publication.year, AVG(publication.citation_num) FROM publication GROUP BY publication.year;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average number of references cited by publications in each domain name?,"SELECT {domain.name,domain.did}, AVG(publication.reference_num) AS average_references FROM domain_publication JOIN publication ON domain_publication.pid = publication.pid JOIN domain ON domain.did = domain_publication.did GROUP BY {};",academic,group_by,,postgres,"SELECT domain.name, AVG(publication.reference_num) FROM domain_publication
JOIN domain ON domain_publication.did = domain.did
JOIN publication ON domain_publication.pid = publication.pid
GROUP BY domain.name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of citations received by each author?,"SELECT {author.name, author.aid}, sum(publication.citation_num) AS total_citations FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid GROUP BY {} ORDER BY total_citations DESC NULLS LAST;SELECT {a.aid, a.name}, COUNT(c.cited) AS total_citations FROM author a JOIN writes w ON a.aid = w.aid JOIN publication p ON w.pid = p.pid JOIN cite c ON p.pid = c.cited GROUP BY {} ORDER BY total_citations DESC;",academic,group_by,,postgres,"SELECT {author.name, author.aid}, sum(publication.citation_num)
FROM author
JOIN writes ON author.aid = writes.aid
JOIN publication ON writes.pid = publication.pid
GROUP BY {}
ORDER BY sum(publication.citation_num) DESC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 1: SELECT {author.name, author.aid}, sum(publication.citation_n...
               ^

[SQL: SELECT {author.name, author.aid}, sum(publication.citation_num)
FROM author
JOIN writes ON author.aid = writes.aid
JOIN publication ON writes.pid = publication.pid
GROUP BY {}
ORDER BY sum(publication.citation_num) DESC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the total number of publications published in each year?,"SELECT publication.year, COUNT(DISTINCT publication.pid) AS total_publications FROM publication GROUP BY publication.year ORDER BY publication.year;",academic,group_by,,postgres,"SELECT publication.year, count(*) FROM publication GROUP BY publication.year ORDER BY publication.year;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"Which authors have written publications in both the domain ""Machine Learning"" and the domain ""Data Science""?","SELECT {author.name,author.aid} FROM author WHERE author.aid IN (SELECT domain_author.aid FROM domain_author WHERE domain_author.did IN (SELECT domain.did FROM DOMAIN WHERE domain.name IN ('Machine Learning', 'Data Science') ) GROUP BY 1 HAVING COUNT(DISTINCT domain_author.did) = 2);",academic,group_by,,postgres,"SELECT DISTINCT a.name FROM author AS a
JOIN writes AS w ON a.aid = w.aid
JOIN domain_publication AS dp ON w.pid = dp.pid
JOIN domain AS d ON dp.did = d.did
WHERE d.name ILIKE '%Machine Learning%'
INTERSECT
SELECT DISTINCT a.name FROM author AS a
JOIN writes AS w ON a.aid = w.aid
JOIN domain_publication AS dp ON w.pid = dp.pid
JOIN domain AS d ON dp.did = d.did
WHERE d.name ILIKE '%Data Science%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the names of the authors who have written publications in the domain ""Computer Science""?",SELECT DISTINCT author.name FROM author JOIN writes ON author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_publication ON publication.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name ilike '%computer%science%';,academic,instruct,"
Follow the instructions below to generate the query:
To get publications written by authors from a given domain, you would need to join domain, domain_author, author to link the domain to the author first, and then join with write to link with the publication id.
You must also filter names using ILIKE.
",postgres,"SELECT DISTINCT name FROM author
JOIN writes ON author.aid = writes.aid
JOIN domain_publication ON writes.pid = domain_publication.pid
JOIN domain ON domain_publication.did = domain.did
WHERE domain.name ILIKE '%Computer Science%';",,"QUERY EXECUTION ERROR: (psycopg2.errors.AmbiguousColumn) column reference ""name"" is ambiguous
LINE 1: SELECT DISTINCT name FROM author
                        ^

[SQL: SELECT DISTINCT name FROM author
JOIN writes ON author.aid = writes.aid
JOIN domain_publication ON writes.pid = domain_publication.pid
JOIN domain ON domain_publication.did = domain.did
WHERE domain.name ILIKE '%%Computer Science%%';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What are the publications written by authors from the 'Sociology' domain and presented at conferences in the year 2020?,"SELECT DISTINCT {publication.title, publication.pid} FROM DOMAIN JOIN domain_author ON domain.did = domain_author.did JOIN writes ON domain_author.aid = writes.aid JOIN publication ON writes.pid = publication.pid JOIN domain_conference ON domain.did = domain_conference.did WHERE domain.name ILIKE '%Sociology%' AND publication.year = 2020 AND publication.cid = domain_conference.cid;",academic,instruct,"
Follow the instructions below to generate the query:
To get publications written by authors from a given domain, you would need to join domain, domain_author, author to link the domain to the author first, and then join with write to link with the publication id.
Finally, to see which ones were presented at conferences, you must join the domain table with the domain_conference table.
You must also filter names using ILIKE.
",postgres,SELECT DISTINCT T1.name FROM domain AS T1 JOIN domain_author AS T2 ON T1.did  =  T2.did JOIN writes AS T3 ON T2.aid  =  T3.aid JOIN publication AS T4 ON T3.pid  =  T4.pid JOIN domain_conference AS T5 ON T4.cid  =  T5.cid WHERE T1.name  =  'Sociology' AND T4.year  =  '2020';,,,0,0,0,0,0,,0,,,,,,,,,,,False
Which authors are not part of any organization?,"SELECT DISTINCT {name, aid} FROM author WHERE oid IS NULL",academic,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,SELECT name FROM author WHERE aid NOT IN (SELECT aid FROM writes);,,,0,0,0,0,0,,0,,,,,,,,,,,False
Which authors belong to the same domain as Martin?,"SELECT DISTINCT {a2.name, a2.aid} FROM author a1 JOIN domain_author da1 ON a1.aid = da1.aid JOIN domain_author da2 ON da1.did = da2.did JOIN author a2 ON da2.aid = a2.aid WHERE LOWER(a1.name) ILIKE '%martin%';",academic,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE with percent sign wildcards
",postgres,"SELECT DISTINCT a.name FROM author AS a
JOIN domain_author AS da ON a.aid  =  da.aid
JOIN domain AS d ON da.did  =  d.did
JOIN organization AS o ON a.oid  =  o.oid
WHERE o.name  =  'Martin';",,,0,0,0,0,0,,0,,,,,,,,,,,False
"Which organizations have authors who have written publications in the domain ""Machine Learning""?","SELECT DISTINCT {organization.name, organization.oid} FROM organization JOIN author ON organization.oid = author.oid JOIN writes ON author.aid = writes.aid JOIN domain_publication ON writes.pid = domain_publication.pid JOIN domain ON domain_publication.did = domain.did WHERE domain.name = 'Machine Learning';",academic,instruct,"
Follow the instructions below to generate the query:
Always filter names using an exact match
",postgres,"SELECT DISTINCT {organization.name, organization.oid} FROM organization
JOIN writes ON organization.oid = writes.aid
JOIN domain_publication ON writes.pid = domain_publication.pid
JOIN domain ON domain_publication.did = domain.did
WHERE domain.name ILIKE '%Machine Learning%';",,"QUERY EXECUTION ERROR: (psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 1: SELECT DISTINCT {organization.name, organization.oid} FROM o...
                        ^

[SQL: SELECT DISTINCT {organization.name, organization.oid} FROM organization
JOIN writes ON organization.oid = writes.aid
JOIN domain_publication ON writes.pid = domain_publication.pid
JOIN domain ON domain_publication.did = domain.did
WHERE domain.name ILIKE '%%Machine Learning%%';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What are the titles of all publications ordered alphabetically?,SELECT DISTINCT publication.title FROM publication ORDER BY publication.title ASC NULLS LAST;,academic,order_by,,postgres,SELECT title FROM publication ORDER BY title ASC;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 3 publications with the highest number of citations?,"SELECT {publication.title, publication.pid}, publication.citation_num FROM publication ORDER BY publication.citation_num DESC LIMIT 3;",academic,order_by,,postgres,"SELECT p.pid, p.title, p.citation_num FROM publication p ORDER BY p.citation_num DESC LIMIT 3;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the top 3 titles of the publications that have the highest number of references cited, ordered by the number of references cited in descending order?",SELECT publication.title FROM publication ORDER BY publication.reference_num DESC LIMIT 3;,academic,order_by,,postgres,SELECT title FROM publication ORDER BY reference_num DESC LIMIT 3;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 5 domains with the highest number of authors associated with them?,"SELECT {d.name, d.did}, COUNT(DISTINCT a.aid) AS author_count FROM author a JOIN domain_author da ON a.aid = da.aid JOIN domain d ON da.did = d.did GROUP BY {} ORDER BY author_count DESC LIMIT 5;",academic,order_by,,postgres,"SELECT domain.name, COUNT(DISTINCT writes.aid) AS author_count
FROM domain
JOIN domain_author ON domain.did = domain_author.did
JOIN author ON domain_author.aid = author.aid
JOIN writes ON author.aid = writes.aid
GROUP BY domain.name
ORDER BY author_count DESC
LIMIT 5;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the title of the publication that has received the highest number of citations?,SELECT publication.title FROM publication ORDER BY publication.citation_num DESC NULLS LAST LIMIT 1;,academic,order_by,,postgres,SELECT title FROM publication ORDER BY citation_num DESC LIMIT 1;,,,1,1,0,0,0,,0,,,,,,,,,,,False
How does the ratio of authors to organizations differ by continent?,"SELECT o.continent, CAST(COUNT(DISTINCT a.aid) AS FLOAT) / NULLIF(COUNT(DISTINCT o.oid), 0) AS author_to_organization_ratio FROM author a JOIN organization o ON a.oid = o.oid GROUP BY o.continent ORDER BY author_to_organization_ratio DESC NULLS LAST;SELECT organization.continent, COUNT(DISTINCT author.aid)::float / NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM organization LEFT JOIN author ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;SELECT organization.continent, COUNT(DISTINCT author.aid)::float / NULLIF(COUNT(DISTINCT organization.oid), 0) AS ratio FROM author LEFT JOIN organization ON author.oid = organization.oid GROUP BY organization.continent ORDER BY ratio DESC NULLS LAST;",academic,ratio,,postgres,"SELECT organization.continent, COUNT(DISTINCT writes.aid)::float / NULLIF(COUNT(DISTINCT author.aid), 0) AS ratio
FROM organization
JOIN author ON organization.oid = author.oid
JOIN writes ON author.aid = writes.aid
GROUP BY organization.continent;",,,0,0,0,0,0,,0,,,,,,,,,,,False
How does the ratio of publications to journals change over the years? Return the annual numbers of publications and journals as well.,"SELECT publication.year, COUNT(DISTINCT publication.pid) AS num_publications, COUNT(DISTINCT publication.jid) AS num_journals, CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio FROM publication GROUP BY publication.year ORDER BY publication.year;",academic,ratio,,postgres,"SELECT publication.year, 
       COUNT(DISTINCT publication.pid)::float / NULLIF(COUNT(DISTINCT publication.pid), 0) AS ratio_publications, 
       COUNT(DISTINCT publication.jid)::float / NULLIF(COUNT(DISTINCT publication.jid), 0) AS ratio_journals
FROM publication
GROUP BY publication.year
ORDER BY publication.year;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of publications presented in conferences to publications published in journals?,"SELECT CAST(COUNT(DISTINCT CASE WHEN cid IS NOT NULL THEN pid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN jid IS NOT NULL THEN pid END), 0) AS ratio FROM publication;",academic,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN cite.cited IN (SELECT pid FROM publication WHERE jid IS NOT NULL) THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN publication.jid IS NOT NULL THEN 1 END), 0) AS ratio;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""cite""
LINE 1: SELECT CAST(COUNT(CASE WHEN cite.cited IN (SELECT pid FROM p...
                                    ^

[SQL: SELECT CAST(COUNT(CASE WHEN cite.cited IN (SELECT pid FROM publication WHERE jid IS NOT NULL) THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN publication.jid IS NOT NULL THEN 1 END), 0) AS ratio;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the ratio of publications to authors in the database?,"SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS publication_to_author_ratio FROM publication, author;",academic,ratio,,postgres,"SELECT CAST(COUNT(DISTINCT publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT author.aid), 0) AS ratio FROM writes JOIN author ON writes.aid = author.aid JOIN publication ON writes.pid = publication.pid;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the total number of publications to the total number of keywords within each domain ID? Show all domain IDs.,"SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_publication LEFT JOIN domain_keyword ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT domain_publication.did, CAST(COUNT(DISTINCT domain_publication.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS publication_to_keyword_ratio FROM domain_keyword LEFT JOIN domain_publication ON domain_publication.did = domain_keyword.did GROUP BY domain_publication.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;SELECT d.did, COALESCE(CAST(COUNT(DISTINCT dp.pid) AS FLOAT) / NULLIF(COUNT(DISTINCT dk.kid), 0), 0) AS publication_to_keyword_ratio FROM domain d LEFT JOIN domain_publication dp ON d.did = dp.did LEFT JOIN domain_keyword dk ON d.did = dk.did GROUP BY d.did ORDER BY publication_to_keyword_ratio DESC NULLS LAST;",academic,ratio,,postgres,"SELECT domain.did, COUNT(DISTINCT domain_publication.pid)::float / NULLIF(COUNT(DISTINCT domain_keyword.kid), 0) AS ratio
FROM domain
JOIN domain_publication ON domain.did = domain_publication.did
JOIN domain_keyword ON domain.did = domain_keyword.did
GROUP BY domain.did;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"How many publications were presented at each conference, ordered by the number of publications in descending order? Give the names of the conferences and their corresponding number of publications.","SELECT conference.name, COUNT(publication.pid) AS num_publications FROM publication JOIN conference ON publication.cid=conference.cid GROUP BY conference.name, conference.cid ORDER BY num_publications DESC NULLS LAST;",academic,table_join,,postgres,"SELECT c.name, count(*) AS publication_count FROM conference AS c
JOIN domain_conference AS dc ON c.cid  =  dc.cid
JOIN publication AS p ON dc.did  =  p.did
GROUP BY c.name
ORDER BY publication_count DESC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column p.did does not exist
LINE 3: JOIN publication AS p ON dc.did  =  p.did
                                            ^

[SQL: SELECT c.name, count(*) AS publication_count FROM conference AS c
JOIN domain_conference AS dc ON c.cid  =  dc.cid
JOIN publication AS p ON dc.did  =  p.did
GROUP BY c.name
ORDER BY publication_count DESC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"How many publications were published in journals whose names start with the letter ""J""?",SELECT count(DISTINCT publication.pid) FROM publication JOIN journal ON publication.jid = journal.jid WHERE journal.name ilike 'J%';,academic,table_join,,postgres,"SELECT count(*) FROM publication p
JOIN writes w ON p.pid = w.pid
JOIN journal j ON p.jid = j.jid
WHERE j.name ilike 'J%';",,,0,0,0,0,0,,0,,,,,,,,,,,False
"What is the total number of publications in each journal, ordered by the number of publications in descending order?","SELECT {journal.name, journal.jid}, COUNT(publication.pid) AS total_publications FROM publication JOIN journal ON publication.jid=journal.jid GROUP BY {} ORDER BY total_publications DESC NULLS LAST;SELECT {journal.name, journal.jid}, COUNT(publication.pid) AS total_publications FROM journal LEFT JOIN publication ON journal.jid=publication.jid GROUP BY {} ORDER BY total_publications DESC NULLS LAST;",academic,table_join,,postgres,"SELECT journal.name, COUNT(publication.pid) AS publication_count FROM journal
JOIN writes ON writes.jid = journal.jid
JOIN publication ON publication.pid = writes.pid
GROUP BY journal.name
ORDER BY publication_count DESC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column writes.jid does not exist
LINE 2: JOIN writes ON writes.jid = journal.jid
                       ^
HINT:  Perhaps you meant to reference the column ""writes.aid"" or the column ""writes.pid"".

[SQL: SELECT journal.name, COUNT(publication.pid) AS publication_count FROM journal
JOIN writes ON writes.jid = journal.jid
JOIN publication ON publication.pid = writes.pid
GROUP BY journal.name
ORDER BY publication_count DESC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the total number of publications presented in each conference?,"SELECT {conference.name, conference.cid}, COUNT(publication.pid) AS total_publications FROM publication JOIN conference ON publication.cid = conference.cid GROUP BY {} ORDER BY total_publications DESC;",academic,table_join,,postgres,"SELECT conference.name, count(publication.pid) AS total_publications
FROM conference
JOIN domain_conference ON conference.cid = domain_conference.cid
JOIN publication ON domain_conference.did = publication.did
GROUP BY conference.name;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column publication.did does not exist
LINE 4: JOIN publication ON domain_conference.did = publication.did
                                                    ^

[SQL: SELECT conference.name, count(publication.pid) AS total_publications
FROM conference
JOIN domain_conference ON conference.cid = domain_conference.cid
JOIN publication ON domain_conference.did = publication.did
GROUP BY conference.name;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which author had the most publications in the year 2021 and how many publications did he/she have that year?,"SELECT {author.name, author.aid}, COUNT(publication.pid) AS publication_count FROM writes JOIN author ON writes.aid = author.aid JOIN publication ON writes.pid = publication.pid WHERE publication.year = 2021 GROUP BY {} ORDER BY publication_count DESC NULLS LAST LIMIT 1;",academic,table_join,,postgres,"SELECT 
  a.name, 
  count(*) AS publication_count, 
  sum(p.citation_num) AS total_citations 
FROM 
  author a 
JOIN 
  writes w ON a.aid = w.aid 
JOIN 
  publication p ON w.pid = p.pid 
WHERE 
  p.year = 2021 
GROUP BY 
  a.name 
ORDER BY 
  publication_count DESC 
LIMIT 1;",,,0,1,0,0,0,,0,,,,,,,,,,,False
How long has it been in days since the last admitted student?,SELECT CURRENT_DATE - max(admit_term) AS duration_since_last_admitted_student FROM student;,advising,date_functions,,postgres,"SELECT extract(DAY FROM CURRENT_DATE - max(admit_term)) AS time_since_last_admitted_student
FROM student;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedFunction) function pg_catalog.date_part(unknown, integer) does not exist
LINE 1: SELECT extract(DAY FROM CURRENT_DATE - max(admit_term)) AS t...
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT extract(DAY FROM CURRENT_DATE - max(admit_term)) AS time_since_last_admitted_student
FROM student;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How many students were predicted to graduate in the last 10 years?,"SELECT count(*) AS num_students_graduated FROM student WHERE predicted_graduation_semester >= DATE_TRUNC('year', CURRENT_DATE) - interval '10 year';",advising,date_functions,,postgres,"SELECT count(*) FROM student
WHERE predicted_graduation_semester >= (current_date - interval '10 year');",,,1,1,0,0,0,,0,,,,,,,,,,,False
Subtract 2 weeks from the most recent predicted graduation date and give the month.,"SELECT DATE_TRUNC('month', s.predicted_graduation_semester - INTERVAL '2 weeks') AS month FROM student s ORDER BY s.predicted_graduation_semester DESC LIMIT 1;SELECT extract(MONTH FROM predicted_graduation_semester - interval '2 weeks') AS month FROM student ORDER BY predicted_graduation_semester DESC LIMIT 1;SELECT to_char(s.predicted_graduation_semester - interval '14 days', 'Month') AS MONTH FROM student s ORDER BY s.predicted_graduation_semester DESC LIMIT 1;",advising,date_functions,,postgres,"SELECT EXTRACT(MONTH FROM predicted_graduation_semester) AS month
FROM student
ORDER BY predicted_graduation_semester DESC
LIMIT 1;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What month were most students admitted?,"SELECT date_trunc('month', s.admit_term) AS month, COUNT(*) AS total_students FROM student s GROUP BY MONTH ORDER BY total_students DESC LIMIT 1;",advising,date_functions,,postgres,"SELECT T1.admit_term::text AS month, COUNT(*) AS total_students
FROM student AS T1
GROUP BY T1.admit_term::text
ORDER BY total_students DESC
LIMIT 1;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What's the average predicted time to graduation since admission in no. of days?,SELECT avg(predicted_graduation_semester - admit_term) AS average_predicted_time_to_graduation FROM student;,advising,date_functions,,postgres,SELECT avg(predicted_graduation_semester - admit_term) AS average_days_since_admission FROM student;,,,1,1,0,0,0,,0,,,,,,,,,,,False
How many course offerings have a final exam and how many do not?,"SELECT course_offering.has_final_exam, COUNT(offering_id) AS num_courses FROM course_offering GROUP BY course_offering.has_final_exam;SELECT COUNT(CASE WHEN co.has_final_exam THEN 1 END) AS num_with_final_exam, COUNT(CASE WHEN NOT co.has_final_exam THEN 1 END) AS num_without_final_exam FROM course_offering co;",advising,group_by,,postgres,"SELECT 
  CASE 
    WHEN EXISTS (SELECT 1 FROM course_offering WHERE has_final_exam) THEN 'Yes'
    ELSE 'No'
  END, 
  CASE 
    WHEN EXISTS (SELECT 1 FROM course_offering WHERE NOT has_final_exam) THEN 'Yes'
    ELSE 'No'
  END
FROM course_offering;",,QUERY EXECUTION ERROR: The column label 'case' is not unique.,0,0,0,1,0,,0,,,,,,,,,,,False
How many courses are offered for each semester id?,"SELECT course_offering.semester, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM course_offering GROUP BY course_offering.semester ORDER BY course_offering.semester;SELECT semester.semester_id, COUNT(DISTINCT course_offering.course_id) AS num_courses FROM semester LEFT JOIN course_offering ON semester.semester_id = course_offering.semester GROUP BY semester.semester_id;",advising,group_by,,postgres,"SELECT course_offering.semester, COUNT(*) AS number_of_courses
FROM course_offering
GROUP BY course_offering.semester;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many courses does each department offer?,"SELECT course.department, COUNT(DISTINCT course.course_id) AS num_courses FROM course GROUP BY course.department ORDER BY num_courses DESC NULLS LAST;",advising,group_by,,postgres,"SELECT course_offering.department, COUNT(DISTINCT course_offering.course_id) AS number_of_courses
FROM course_offering
GROUP BY course_offering.department;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column course_offering.department does not exist
LINE 1: SELECT course_offering.department, COUNT(DISTINCT course_off...
               ^

[SQL: SELECT course_offering.department, COUNT(DISTINCT course_offering.course_id) AS number_of_courses
FROM course_offering
GROUP BY course_offering.department;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the average clarity score for each instructor who taught a course?,"SELECT {i.name, i.instructor_id}, AVG(c.clarity_score) FROM course c JOIN course_offering co ON c.course_id = co.course_id JOIN offering_instructor oi ON co.offering_id = oi.offering_id JOIN instructor i ON oi.instructor_id = i.instructor_id GROUP BY {};",advising,group_by,,postgres,"SELECT instructor.name, AVG(course.clarity_score) AS average_clarity_score FROM instructor JOIN course ON instructor.instructor_id = course.course_id GROUP BY instructor.name;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the total number of students who found the instructor to be hilarious per course id?,"SELECT course_tags_count.course_id, SUM(course_tags_count.hilarious) AS total_hilarious FROM course_tags_count GROUP BY course_tags_count.course_id;",advising,group_by,,postgres,"SELECT course_offering.course_id, COUNT(*) AS total_hilarious_students FROM course_offering
JOIN offering_instructor ON course_offering.offering_id = offering_instructor.offering_id
JOIN instructor ON offering_instructor.instructor_id = instructor.instructor_id
WHERE instructor.name ILIKE '%hilarious%'
GROUP BY course_offering.course_id;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Return the student IDs who have taken an in-person course and have gotten a grade of A or C.,"SELECT DISTINCT student_id FROM student_record WHERE student_record.how = 'in-person' AND student_record.grade IN ('A', 'C');",advising,instruct,"
Follow the instructions below to generate the query:
Always filter strings with an exact match.
When asked for specific students or courses, do not return duplicates.
",postgres,"SELECT DISTINCT student_id FROM student_record
JOIN course_offering ON student_record.offering_id = course_offering.offering_id
JOIN course_tags_count ON course_offering.course_id = course_tags_count.course_id
WHERE course_offering.has_final_project = TRUE AND course_tags_count.grade IN ('A', 'C');",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column course_tags_count.grade does not exist
LINE 4: ...HERE course_offering.has_final_project = TRUE AND course_tag...
                                                             ^

[SQL: SELECT DISTINCT student_id FROM student_record
JOIN course_offering ON student_record.offering_id = course_offering.offering_id
JOIN course_tags_count ON course_offering.course_id = course_tags_count.course_id
WHERE course_offering.has_final_project = TRUE AND course_tags_count.grade IN ('A', 'C');]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"What are the easiness scores for courses in the ""Computer Science"" department? Show both courses and scores.","SELECT {course.name, course.course_id, course.number}, course.easiness_score FROM course WHERE course.department = 'Computer Science';",advising,instruct,"
Follow the instructions below to generate the query:
Always filter names using exact string matching
",postgres,"SELECT course.name, course.easiness_score FROM course
JOIN program ON course.course_id = program.course_id
WHERE program.name ILIKE '%Computer Science%';",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column program.course_id does not exist
LINE 2: JOIN program ON course.course_id = program.course_id
                                           ^

[SQL: SELECT course.name, course.easiness_score FROM course
JOIN program ON course.course_id = program.course_id
WHERE program.name ILIKE '%%Computer Science%%';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What are the names of all the courses offered by the department of Computer Science?,SELECT course.name FROM course WHERE course.department ILIKE '%Computer Science%' ORDER BY course.name ASC NULLS LAST;,advising,instruct,"
Follow the instructions below to generate the query:
Filter strings using ILIKE.
Use the student_record table for all information relating to students' choices and their course.
",postgres,SELECT name FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course.department ILIKE '%Computer Science%';,,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average GPA of students in the program mathematics?,SELECT AVG(student.total_gpa) FROM student JOIN program ON student.program_id = program.program_id WHERE LOWER(program.name) = 'mathematics';,advising,instruct,"
Follow the instructions below to generate the query:
Match strings case-insensitively
",postgres,SELECT avg(t1.total_gpa) FROM student AS t1 JOIN program AS t2 ON t1.program_id  =  t2.program_id WHERE t2.name  =  'Mathematics';,,,1,1,0,0,0,,0,,,,,,,,,,,False
Which students have declared a minor program? List their firstname and lastname. Order the results by the students' last names.,"SELECT student.firstname, student.lastname FROM student WHERE student.minor IS NOT NULL ORDER BY student.lastname NULLS LAST;",advising,instruct,"
Follow the instructions below to generate the query:
student.declare_major is null for students who have not declared their major.
student.minor is null for students who have not declared a minor program.
",postgres,"SELECT t3.firstname,  t3.lastname FROM student AS t1
JOIN student_record AS t2 ON t1.student_id  =  t2.student_id
JOIN course AS t3 ON t2.course_id  =  t3.course_id
WHERE t1.minor  =  'Computer Science'
ORDER BY t3.lastname;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t3.firstname does not exist
LINE 1: SELECT t3.firstname,  t3.lastname FROM student AS t1
               ^
HINT:  Perhaps you meant to reference the column ""t1.firstname"".

[SQL: SELECT t3.firstname,  t3.lastname FROM student AS t1
JOIN student_record AS t2 ON t1.student_id  =  t2.student_id
JOIN course AS t3 ON t2.course_id  =  t3.course_id
WHERE t1.minor  =  'Computer Science'
ORDER BY t3.lastname;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"What is the name of the instructor who has taught the most courses, and how many courses have they taught?","SELECT instructor.name, count(offering_instructor.offering_id) AS num_courses FROM offering_instructor JOIN instructor ON offering_instructor.instructor_id = instructor.instructor_id GROUP BY instructor.name ORDER BY num_courses DESC LIMIT 1;",advising,order_by,,postgres,"SELECT T1.name,  COUNT(*) FROM instructor AS T1 JOIN course_offering AS T2 ON T1.instructor_id  =  T2.instructor_id GROUP BY T1.name ORDER BY COUNT(*) DESC LIMIT 1;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t2.instructor_id does not exist
LINE 1: ...OIN course_offering AS T2 ON T1.instructor_id  =  T2.instruc...
                                                             ^
HINT:  Perhaps you meant to reference the column ""t1.instructor_id"".

[SQL: SELECT T1.name,  COUNT(*) FROM instructor AS T1 JOIN course_offering AS T2 ON T1.instructor_id  =  T2.instructor_id GROUP BY T1.name ORDER BY COUNT(*) DESC LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"What is the total number of credits earned by each student, ordered from highest to lowest? Give the student id and the total number of credits.","SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC NULLS LAST;",advising,order_by,,postgres,"SELECT student.student_id, student.total_credit FROM student ORDER BY student.total_credit DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of students enrolled in each course, ordered from highest to lowest?","SELECT {course.course_id, course.name, course.number}, SUM(course.num_enrolled) AS total_students FROM course GROUP BY {} ORDER BY total_students DESC NULLS LAST;",advising,order_by,,postgres,"SELECT course.course_id, course.name, sum(course.num_enrolled) AS total_students FROM course GROUP BY course.course_id, course.name ORDER BY total_students DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of students who participated actively for each course id, ordered from highest to lowest participants?","SELECT course_tags_count.course_id, course_tags_count.participation FROM course_tags_count ORDER BY course_tags_count.participation DESC NULLS LAST;",advising,order_by,,postgres,"SELECT course_offering.course_id, COUNT(DISTINCT student_record.student_id) AS number_of_participants
FROM course_offering
JOIN student_record ON course_offering.offering_id = student_record.offering_id
GROUP BY course_offering.course_id
ORDER BY number_of_participants DESC;",,,0,0,0,0,0,,0,,,,,,,,,,,False
"Which course has the highest number of enrolled students, and what is the enrollment number?","SELECT {course.name, course.course_id, course.number}, course.num_enrolled FROM course ORDER BY course.num_enrolled DESC NULLS LAST LIMIT 1;",advising,order_by,,postgres,"SELECT course.course_id, course.name, course.number, course.credits, course.has_projects, course.has_exams, course.has_discussion, course.has_lab, course.enrolled_students FROM course ORDER BY course.enrolled_students DESC LIMIT 1;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column course.enrolled_students does not exist
LINE 1: ...has_exams, course.has_discussion, course.has_lab, course.enr...
                                                             ^

[SQL: SELECT course.course_id, course.name, course.number, course.credits, course.has_projects, course.has_exams, course.has_discussion, course.has_lab, course.enrolled_students FROM course ORDER BY course.enrolled_students DESC LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How does the ratio of enrolled students to the number of reviews vary across different courses?,"SELECT {course.course_id, course.name, course.number}, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS student_review_ratio FROM course ORDER BY student_review_ratio NULLS LAST;",advising,ratio,,postgres,"SELECT course.course_id, course.name, course.number, CAST(course.num_enrolled AS FLOAT) / NULLIF(course.num_reviews, 0) AS ratio
FROM course
ORDER BY ratio DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of helpfulness scores to clarity scores for each course ID?,"SELECT course.course_id, CAST(course.helpfulness_score AS FLOAT) / NULLIF(course.clarity_score, 0) AS ratio FROM course;",advising,ratio,,postgres,"SELECT course.course_id, CAST(course.helpfulness_score AS FLOAT) / NULLIF(course.clarity_score, 0) AS ratio
FROM course;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the number of courses with projects to the number of courses with exams in each semester id?,"SELECT course_offering.semester, CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio FROM course JOIN course_offering ON course.course_id = course_offering.course_id GROUP BY course_offering.semester ORDER BY course_offering.semester NULLS LAST;",advising,ratio,,postgres,"SELECT 
    course_offering.semester, 
    CAST(SUM(CASE WHEN course.has_projects THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course.has_exams THEN 1 ELSE 0 END), 0) AS ratio
FROM 
    course
JOIN 
    course_offering ON course.course_id = course_offering.course_id
GROUP BY 
    course_offering.semester;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the number of students who found the grading criteria clear and easy to understand to the number of students who received good feedback from the instructor for each course id?,"SELECT course_tags_count.course_id, CAST(course_tags_count.clear_grading AS FLOAT) / NULLIF(course_tags_count.good_feedback, 0) AS ratio FROM course_tags_count ORDER BY course_tags_count.course_id NULLS LAST;",advising,ratio,,postgres,"SELECT course_offering.course_id,
       CAST(SUM(CASE WHEN course_tags_count.clear_grading > 0 AND course_tags_count.good_feedback > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN course_tags_count.good_feedback > 0 THEN 1 ELSE 0 END), 0) AS ratio
FROM course_offering
JOIN course_tags_count ON course_offering.course_id = course_tags_count.course_id
GROUP BY course_offering.course_id;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the total number of students enrolled in courses with exams to the total number of students enrolled in courses without exams?,SELECT SUM(CASE WHEN c.has_exams THEN c.num_enrolled ELSE 0 END)::FLOAT / SUM(CASE WHEN NOT c.has_exams THEN c.num_enrolled ELSE 0 END) AS ratio FROM course c;,advising,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN course.has_exams THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN NOT course.has_exams THEN 1 END), 0) AS ratio;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""course""
LINE 1: SELECT CAST(COUNT(CASE WHEN course.has_exams THEN 1 END) AS ...
                                    ^

[SQL: SELECT CAST(COUNT(CASE WHEN course.has_exams THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN NOT course.has_exams THEN 1 END), 0) AS ratio;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How many students have declared a major in each program?,"SELECT {program.name, program.program_id}, COUNT(student.student_id) AS number_of_students FROM student JOIN program ON student.program_id = program.program_id WHERE student.declare_major IS NOT NULL GROUP BY {} ORDER BY number_of_students DESC;",advising,table_join,,postgres,"SELECT T1.program_id, T1.name, T2.declare_major, COUNT(*) AS number_of_students
FROM student AS T1
JOIN program AS T2 ON T1.program_id = T2.program_id
GROUP BY T1.program_id, T1.name, T2.declare_major;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t1.name does not exist
LINE 1: SELECT T1.program_id, T1.name, T2.declare_major, COUNT(*) AS...
                              ^
HINT:  Perhaps you meant to reference the column ""t2.name"".

[SQL: SELECT T1.program_id, T1.name, T2.declare_major, COUNT(*) AS number_of_students
FROM student AS T1
JOIN program AS T2 ON T1.program_id = T2.program_id
GROUP BY T1.program_id, T1.name, T2.declare_major;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the total number of credits earned by students in each program?,"SELECT {program.name, program.program_id}, SUM(student.total_credit) AS total_credits FROM student JOIN program ON student.program_id = program.program_id GROUP BY {};",advising,table_join,,postgres,"SELECT program.name, program.program_id, SUM(student.total_credit) AS total_credits
FROM student
JOIN program ON student.program_id = program.program_id
GROUP BY program.name, program.program_id;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of students who have taken a course with a final project or exam?,SELECT COUNT(DISTINCT student_record.student_id) AS total_students FROM student_record JOIN course_offering ON student_record.course_id = course_offering.course_id WHERE course_offering.has_final_project = true OR course_offering.has_final_exam = true;,advising,table_join,,postgres,"SELECT count(*) FROM student_record
JOIN course_offering ON student_record.offering_id = course_offering.offering_id
WHERE course_offering.has_final_project OR course_offering.has_final_exam;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Which courses have a final project and a final exam?,"SELECT DISTINCT {course.name, course.course_id, course.number} FROM course_offering JOIN course ON course_offering.course_id = course.course_id WHERE course_offering.has_final_project = true AND course_offering.has_final_exam = true;",advising,table_join,,postgres,"SELECT DISTINCT {course.course_id, course.name, course.number} FROM course
JOIN course_offering ON course.course_id = course_offering.course_id
WHERE course_offering.has_final_project AND course_offering.has_final_exam;",,"QUERY EXECUTION ERROR: (psycopg2.errors.SyntaxError) syntax error at or near ""{""
LINE 1: SELECT DISTINCT {course.course_id, course.name, course.numbe...
                        ^

[SQL: SELECT DISTINCT {course.course_id, course.name, course.number} FROM course
JOIN course_offering ON course.course_id = course_offering.course_id
WHERE course_offering.has_final_project AND course_offering.has_final_exam;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which courses have been taken by students in the Computer Science program?,"SELECT DISTINCT {course.name, course.course_id, course.number} AS course_name FROM student JOIN student_record ON student.student_id = student_record.student_id JOIN program ON student.program_id = program.program_id JOIN course ON student_record.course_id = course.course_id WHERE program.name ILIKE '%Computer Science%';",advising,table_join,,postgres,SELECT DISTINCT t2.name FROM student AS t1 JOIN student_record AS t2 ON t1.student_id  =  t2.course_id WHERE t1.program_id  =  (SELECT program_id FROM program WHERE name  =  'Computer Science');,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t2.name does not exist
LINE 1: SELECT DISTINCT t2.name FROM student AS t1 JOIN student_reco...
                        ^

[SQL: SELECT DISTINCT t2.name FROM student AS t1 JOIN student_record AS t2 ON t1.student_id  =  t2.course_id WHERE t1.program_id  =  (SELECT program_id FROM program WHERE name  =  'Computer Science');]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Count the number of flight departures for each month?,"SELECT month.month_name, count(*) AS departure_count FROM flight JOIN month ON extract(MONTH FROM to_timestamp(flight.departure_time)) = month.month_number GROUP BY month.month_name, month.month_number ORDER BY month.month_number;SELECT date_trunc('month', to_timestamp(flight.departure_time)) AS month, COUNT(*) AS num_departures FROM flight GROUP BY MONTH ORDER BY MONTH;",atis,date_functions,,postgres,"SELECT month.month_name, count(*) FROM flight
JOIN month ON flight.departure_time::date = month.month_number
GROUP BY month.month_name;",,"QUERY EXECUTION ERROR: (psycopg2.errors.CannotCoerce) cannot cast type bigint to date
LINE 2: JOIN month ON flight.departure_time::date = month.month_numb...
                                           ^

[SQL: SELECT month.month_name, count(*) FROM flight
JOIN month ON flight.departure_time::date = month.month_number
GROUP BY month.month_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"What's the average duration between departure and arrival times minus 34 minutes? Convert from UNIX to regular datetime, and return the answer in minutes",SELECT avg(to_timestamp(arrival_time) - to_timestamp(departure_time) - interval '34 minutes') AS average_duration FROM flight;SELECT AVG(arrival_time - departure_time)/60 - 34 AS average_duration FROM flight;,atis,date_functions,,postgres,SELECT avg(EXTRACT(EPOCH FROM (arrival_time - departure_time)) - 34) AS average_duration_minutes FROM flight;,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedFunction) function pg_catalog.date_part(unknown, bigint) does not exist
LINE 1: SELECT avg(EXTRACT(EPOCH FROM (arrival_time - departure_time...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT avg(EXTRACT(EPOCH FROM (arrival_time - departure_time)) - 34) AS average_duration_minutes FROM flight;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What's the difference in time in days between today and the earliest flight departure?,"SELECT date_part('day', CURRENT_DATE - to_timestamp(departure_time)) AS difference_in_days FROM flight ORDER BY departure_time LIMIT 1;SELECT (CURRENT_DATE - TO_TIMESTAMP(MIN(f.departure_time))) AS days_difference FROM flight f;",atis,date_functions,,postgres,"SELECT 
  EXTRACT(DAY FROM (CURRENT_DATE - to_date(min(departure_time), 'YYYY-MM-DD'))) AS time_difference_days
FROM 
  flight;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedFunction) function to_date(bigint, unknown) does not exist
LINE 2:   EXTRACT(DAY FROM (CURRENT_DATE - to_date(min(departure_tim...
                                           ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: SELECT 
  EXTRACT(DAY FROM (CURRENT_DATE - to_date(min(departure_time), 'YYYY-MM-DD'))) AS time_difference_days
FROM 
  flight;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What's the earliest flight departure time in the day in HH:MM?,"SELECT to_char(to_timestamp(departure_time)::TIME, 'HH24:MI') AS earliest_departure_time FROM flight ORDER BY earliest_departure_time LIMIT 1;",atis,date_functions,,postgres,"SELECT to_char(departure_time, 'HH24:MI') AS earliest_departure_time FROM flight ORDER BY departure_time ASC LIMIT 1;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Which flight has the shortest duration between departure and arrival times? Convert to minutes.,"SELECT {flight.flight_number, flight.flight_id}, (arrival_time - departure_time) / 60 AS duration_minutes FROM flight ORDER BY duration_minutes LIMIT 1;",atis,date_functions,,postgres,"SELECT flight_id FROM flight
ORDER BY departure_time - arrival_time ASC
LIMIT 1;",,,0,0,0,0,0,,0,,,,,,,,,,,False
"How many flights depart from each airport code, excluding departures with connections?","SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport LEFT JOIN flight ON airport.airport_code = flight.from_airport AND flight.connections=0 GROUP BY airport.airport_code;SELECT airport.airport_code, COUNT(flight.from_airport) AS num_departures FROM airport JOIN flight ON airport.airport_code = flight.from_airport WHERE flight.connections=0 GROUP BY airport.airport_code;",atis,group_by,,postgres,"SELECT fare.from_airport, COUNT(*) AS number_of_flights
FROM flight
WHERE connections > 0
GROUP BY fare.from_airport;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""fare""
LINE 1: SELECT fare.from_airport, COUNT(*) AS number_of_flights
               ^

[SQL: SELECT fare.from_airport, COUNT(*) AS number_of_flights
FROM flight
WHERE connections > 0
GROUP BY fare.from_airport;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"How many meals are served in each compartment, sorted by the number of meals in descending order?","SELECT food_service.compartment, COUNT(food_service.meal_number) AS number_of_meals FROM food_service GROUP BY food_service.compartment ORDER BY number_of_meals DESC NULLS LAST;",atis,group_by,,postgres,"SELECT food_service.compartment, COUNT(food_service.meal_code) AS number_of_meals
FROM food_service
GROUP BY food_service.compartment
ORDER BY number_of_meals DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average cost of a one-way trip for each airport pair in the fare table?,"SELECT f.from_airport, f.to_airport, AVG(f.one_direction_cost) AS average_cost FROM fare f GROUP BY f.from_airport, f.to_airport ORDER BY f.from_airport, f.to_airport NULLS LAST;",atis,group_by,,postgres,"SELECT fare.from_airport, fare.to_airport, avg(fare.one_direction_cost) FROM fare GROUP BY fare.from_airport, fare.to_airport;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the average cost of round-trip fares from Los Angeles (LAX) to Chicago (ORD) for each airline, sorted in descending order by average cost?","SELECT fare.fare_airline, AVG(fare.round_trip_cost) AS average_cost FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.fare_airline ORDER BY average_cost DESC NULLS LAST;SELECT airline.airline_name, AVG(fare.round_trip_cost) AS avg_round_trip_cost FROM fare JOIN airline ON fare.fare_airline = airline.airline_code WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY airline.airline_name ORDER BY avg_round_trip_cost DESC;",atis,group_by,,postgres,"SELECT fare.round_trip_cost, fare.fare_airline FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.fare_airline ORDER BY AVG(fare.round_trip_cost) DESC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.GroupingError) column ""fare.round_trip_cost"" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT fare.round_trip_cost, fare.fare_airline FROM fare WHE...
               ^

[SQL: SELECT fare.round_trip_cost, fare.fare_airline FROM fare WHERE fare.from_airport = 'LAX' AND fare.to_airport = 'ORD' GROUP BY fare.fare_airline ORDER BY AVG(fare.round_trip_cost) DESC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the total cost of round-trip fares for each airline code?,"SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare GROUP BY fare.fare_airline ORDER BY total_round_trip_cost DESC;",atis,group_by,,postgres,"SELECT fare.fare_airline, SUM(fare.round_trip_cost) AS total_round_trip_cost
FROM fare
GROUP BY fare.fare_airline;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many flights require a round-trip to purchase the fare?,SELECT COUNT(DISTINCT flight_fare.flight_id) FROM flight_fare JOIN fare ON flight_fare.fare_id = fare.fare_id WHERE fare.round_trip_required = 'Yes';,atis,instruct,"
Follow the instructions below to generate the query:
Filter airport, city, country names using ILIKE.
Filter state code (eg NY) and airport codes (eg JFK) using upper-case matches.
",postgres,"SELECT count(*) FROM fare
JOIN flight ON fare.round_trip_cost > 0;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the minimum amount of time required for a connecting flight at JFK Airport?,SELECT minimum_connect_time FROM airport WHERE airport_code = 'JFK';,atis,instruct,"
Follow the instructions below to generate the query:
Filter airport, city, country names using ILIKE.
Filter state code (eg NY) and airport codes (eg JFK) using upper-case matches.
",postgres,SELECT min(departure_time) FROM flight_stop WHERE stop_airport ILIKE 'JFK';,,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the total cost of all round-trip fares from New York (JFK) to Los Angeles?,SELECT SUM(fare.round_trip_cost) AS total_round_trip_cost FROM fare WHERE fare.from_airport = 'JFK' AND fare.to_airport = 'LAX';,atis,instruct,"
Follow the instructions below to generate the query:
Filter airport, city, country names using ILIKE.
Filter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.
fare.round_trip_required is not needed when getting the round trip cost.
",postgres,SELECT sum(round_trip_cost) FROM fare WHERE from_airport ILIKE 'JFK' AND to_airport ILIKE 'LAX';,,,1,1,0,0,0,,0,,,,,,,,,,,False
Which flights operate on Mondays and Wednesdays? Give me the relevant flight numbers,"SELECT {flight.flight_number, flight.flight_id} FROM flight WHERE LOWER(flight.flight_days) LIKE '%mon%' AND LOWER(flight.flight_days) LIKE '%wed%';",atis,instruct,"
Follow the instructions below to generate the query:
Filter airport, city, country names using ILIKE.
Filter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.
If multiple flight days are requested, use ILIKE for each of the days separately, since they are not necessarily ordered.
",postgres,SELECT flight_number FROM flight WHERE flight_days ILIKE '%MON%' AND flight_days ILIKE '%WED%';,,,1,1,0,0,0,,0,,,,,,,,,,,False
Which state code is Orlando International Airport in?,SELECT state_code FROM airport WHERE airport_name ILIKE '%Orlando International Airport%';,atis,instruct,"
Follow the instructions below to generate the query:
Filter airport, city, country names using ILIKE.
Filter state code (eg NY), airport codes (eg JFK) using case-insensitive matches.
If multiple flight days are requested, use ILIKE and wildcards for each of the days separately, since they are not necessarily ordered.
",postgres,SELECT state_code FROM airport WHERE airport_name ILIKE 'Orlando International Airport';,,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the aircraft codes for all aircraft with a cruising speed of over 200 mph? sort the aircraft codes in ascending order.,SELECT aircraft.aircraft_code FROM aircraft WHERE aircraft.cruising_speed > 200 ORDER BY aircraft.aircraft_code ASC NULLS LAST;,atis,order_by,,postgres,SELECT aircraft_code FROM aircraft WHERE cruising_speed > 200 ORDER BY aircraft_code ASC;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 2 airlines with the most flights?,"SELECT {airline.airline_name, airline.airline_code}, COUNT(flight.flight_id) AS number_of_flights FROM flight JOIN airline ON flight.airline_code = airline.airline_code GROUP BY {} ORDER BY number_of_flights DESC NULLS LAST LIMIT 2;",atis,order_by,,postgres,"SELECT t1.airline_name,  count(*) AS number_of_flights FROM flight AS t1 JOIN airline AS t2 ON t1.airline_code  =  t2.airline_code GROUP BY t1.airline_name ORDER BY number_of_flights DESC LIMIT 2;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t1.airline_name does not exist
LINE 1: SELECT t1.airline_name,  count(*) AS number_of_flights FROM ...
               ^
HINT:  Perhaps you meant to reference the column ""t2.airline_name"".

[SQL: SELECT t1.airline_name,  count(*) AS number_of_flights FROM flight AS t1 JOIN airline AS t2 ON t1.airline_code  =  t2.airline_code GROUP BY t1.airline_name ORDER BY number_of_flights DESC LIMIT 2;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which aircraft code can carry the highest weight of cargo that any aircraft can carry?,SELECT aircraft.aircraft_code FROM aircraft ORDER BY pay_load DESC NULLS LAST LIMIT 1;,atis,order_by,,postgres,SELECT aircraft_code FROM aircraft ORDER BY payload DESC LIMIT 1;,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""payload"" does not exist
LINE 1: SELECT aircraft_code FROM aircraft ORDER BY payload DESC LIM...
                                                    ^
HINT:  Perhaps you meant to reference the column ""aircraft.pay_load"".

[SQL: SELECT aircraft_code FROM aircraft ORDER BY payload DESC LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"Which airports have the shortest minimum connect time, sorted in ascending order? Show the minimum connect time.","SELECT {airport.airport_name, airport.airport_code}, airport.minimum_connect_time FROM airport ORDER BY airport.minimum_connect_time ASC NULLS LAST;",atis,order_by,,postgres,"SELECT airport_name,  minimum_connect_time FROM airport ORDER BY minimum_connect_time ASC NULLS LAST;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"Which flight ids to Chicago (ORD) have the longest duration from departure to arrival, sorted in ascending order?","SELECT flight.flight_id, (flight.arrival_time - flight.departure_time) AS duration FROM flight WHERE to_airport = 'ORD' ORDER BY duration ASC NULLS LAST;",atis,order_by,,postgres,"SELECT flight_id FROM flight
WHERE from_airport  =  'ORD'
ORDER BY time_elapsed ASC NULLS LAST;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Calculate the ratio of the maximum range to the maximum payload for each aircraft,"SELECT aircraft.range_miles::float / NULLIF(aircraft.pay_load, 0) AS range_to_payload_ratio FROM aircraft;",atis,ratio,,postgres,"SELECT aircraft.aircraft_description, 
       CAST(MAX(CAST(aircraft.range_miles AS FLOAT) / NULLIF(aircraft.pay_load, 0))) AS ratio
FROM aircraft
GROUP BY aircraft.aircraft_description;",,"QUERY EXECUTION ERROR: (psycopg2.errors.SyntaxError) syntax error at or near "")""
LINE 2: ...ge_miles AS FLOAT) / NULLIF(aircraft.pay_load, 0))) AS ratio
                                                             ^

[SQL: SELECT aircraft.aircraft_description, 
       CAST(MAX(CAST(aircraft.range_miles AS FLOAT) / NULLIF(aircraft.pay_load, 0))) AS ratio
FROM aircraft
GROUP BY aircraft.aircraft_description;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How does the average ratio of the cruising speed to the payload of an aircraft vary across different aircraft manufacturers?,"SELECT aircraft.manufacturer, AVG(CAST(aircraft.cruising_speed AS FLOAT) / NULLIF(aircraft.pay_load, 0)) AS speed_payload_ratio FROM aircraft GROUP BY aircraft.manufacturer ORDER BY speed_payload_ratio DESC NULLS LAST;",atis,ratio,,postgres,"SELECT aircraft.manufacturer, AVG(CAST(aircraft.cruising_speed AS FLOAT) / NULLIF(aircraft.pay_load, 0)) AS speed_payload_ratio
FROM aircraft
GROUP BY aircraft.manufacturer;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the proportion of flights with stops out of all flights for each airline code?,"SELECT flight.airline_code, CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM flight GROUP BY flight.airline_code;",atis,ratio,,postgres,"SELECT 
    flight.airline_code, 
    CAST(SUM(CASE WHEN flight.stops > 0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio
FROM 
    flight
GROUP BY 
    flight.airline_code;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of aircraft capacity to its range in miles for each aircraft code?,"SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) / NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio FROM aircraft;",atis,ratio,,postgres,"SELECT aircraft.aircraft_code, CAST(aircraft.capacity AS FLOAT) / NULLIF(aircraft.range_miles, 0) AS capacity_range_ratio
FROM aircraft;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of one-way trip costs to round-trip costs for each fare?,"SELECT fare.fare_id, fare.one_direction_cost::float / NULLIF(fare.round_trip_cost, 0) AS cost_ratio FROM fare ORDER BY cost_ratio;",atis,ratio,,postgres,"SELECT fare.fare_id, fare.one_direction_cost::float / NULLIF(fare.round_trip_cost, 0) AS ratio
FROM fare;",,,0,1,0,0,0,,0,,,,,,,,,,,False
"Which airlines do not have any flights that either depart from/arrive at JFK, or have one or more stops?","SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM airline WHERE airline.airline_code NOT IN (SELECT flight.airline_code FROM flight WHERE flight.from_airport = 'JFK' OR flight.to_airport = 'JFK' OR flight.stops > 0);",atis,table_join,,postgres,"SELECT DISTINCT airline_name FROM flight
WHERE from_airport!= 'JFK' AND to_airport!= 'JFK' OR stops > 0;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""airline_name"" does not exist
LINE 1: SELECT DISTINCT airline_name FROM flight
                        ^
HINT:  Perhaps you meant to reference the column ""flight.airline_code"".

[SQL: SELECT DISTINCT airline_name FROM flight
WHERE from_airport!= 'JFK' AND to_airport!= 'JFK' OR stops > 0;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"Which airlines offer flights from Chicago (ORD) to New York (JFK), and how many stops do they have, sorted by number of stops in ascending order?","SELECT {airline.airline_name, airline.airline_code}, flight.stops FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'ORD' AND flight.to_airport = 'JFK' ORDER BY flight.stops NULLS LAST;",atis,table_join,,postgres,"SELECT fare.fare_airline, COUNT(flight_stop.stop_number) AS number_of_stops FROM fare JOIN flight_stop ON fare.flight_id = flight_stop.flight_id WHERE fare.from_airport = 'ORD' AND fare.to_airport = 'JFK' GROUP BY fare.fare_airline ORDER BY number_of_stops ASC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column fare.flight_id does not exist
LINE 1: ... AS number_of_stops FROM fare JOIN flight_stop ON fare.fligh...
                                                             ^

[SQL: SELECT fare.fare_airline, COUNT(flight_stop.stop_number) AS number_of_stops FROM fare JOIN flight_stop ON fare.flight_id = flight_stop.flight_id WHERE fare.from_airport = 'ORD' AND fare.to_airport = 'JFK' GROUP BY fare.fare_airline ORDER BY number_of_stops ASC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which airlines offer flights from LAX to ORD?,"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight JOIN airline ON flight.airline_code = airline.airline_code WHERE flight.from_airport = 'LAX' AND flight.to_airport = 'ORD';",atis,table_join,,postgres,SELECT DISTINCT fare_airline FROM flight WHERE from_airport  =  'LAX' AND to_airport  =  'ORD';,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""fare_airline"" does not exist
LINE 1: SELECT DISTINCT fare_airline FROM flight WHERE from_airport ...
                        ^

[SQL: SELECT DISTINCT fare_airline FROM flight WHERE from_airport  =  'LAX' AND to_airport  =  'ORD';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which airlines offer flights with a stopover in Dallas?,"SELECT DISTINCT {airline.airline_name, airline.airline_code} FROM flight_stop JOIN airport ON flight_stop.stop_airport = airport.airport_code JOIN flight ON flight_stop.flight_id = flight.flight_id JOIN airline ON flight.airline_code = airline.airline_code WHERE airport.airport_location ILIKE '%Dallas%';",atis,table_join,,postgres,SELECT DISTINCT fare_airline FROM flight_stop WHERE stop_airport  =  'DALLAS';,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""fare_airline"" does not exist
LINE 1: SELECT DISTINCT fare_airline FROM flight_stop WHERE stop_air...
                        ^

[SQL: SELECT DISTINCT fare_airline FROM flight_stop WHERE stop_airport  =  'DALLAS';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Which flights serve meals in first class? Give me the flight id and meal description.,"SELECT flight.flight_id, food_service.meal_description FROM flight JOIN food_service ON flight.meal_code = food_service.meal_code WHERE LOWER(food_service.compartment) LIKE '%first class%';",atis,table_join,,postgres,"SELECT flight_id, meal_description FROM food_service
JOIN meal ON food_service.meal_code = meal.meal_code
WHERE meal.compartment = 'First Class';",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedTable) relation ""meal"" does not exist
LINE 2: JOIN meal ON food_service.meal_code = meal.meal_code
             ^

[SQL: SELECT flight_id, meal_description FROM food_service
JOIN meal ON food_service.meal_code = meal.meal_code
WHERE meal.compartment = 'First Class';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How many lakes are there in each state?,"SELECT lake.state_name, COUNT(lake.lake_name) AS lake_count FROM lake GROUP BY lake.state_name ORDER BY lake_count DESC;",geography,group_by,,postgres,"SELECT LK.state_name, COUNT(*) AS lake_count FROM lake AS LK JOIN city AS CT ON LK.country_name  =  CT.country_name JOIN state AS ST ON ST.state_name  =  LK.state_name GROUP BY LK.state_name;",,,0,0,0,0,0,,0,,,,,,,,,,,False
How many mountains are there in each country?,"SELECT mountain.country_name, COUNT(mountain.mountain_name) AS number_of_mountains FROM mountain GROUP BY mountain.country_name ORDER BY number_of_mountains DESC;",geography,group_by,,postgres,"SELECT mountain.country_name, COUNT(*) AS number_of_mountains
FROM mountain
GROUP BY mountain.country_name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many rivers flow through each country?,"SELECT river.country_name, COUNT(DISTINCT river.river_name) AS number_of_rivers FROM river GROUP BY river.country_name ORDER BY number_of_rivers DESC;",geography,group_by,,postgres,"SELECT L1.country_name, COUNT(L1.river_name) AS number_of_rivers
FROM Lake AS L1
JOIN river AS L2 ON L1.country_name = L2.country_name
GROUP BY L1.country_name;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column l1.river_name does not exist
LINE 1: SELECT L1.country_name, COUNT(L1.river_name) AS number_of_ri...
                                      ^
HINT:  Perhaps you meant to reference the column ""l2.river_name"".

[SQL: SELECT L1.country_name, COUNT(L1.river_name) AS number_of_rivers
FROM Lake AS L1
JOIN river AS L2 ON L1.country_name = L2.country_name
GROUP BY L1.country_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the average length of rivers in each country?,"SELECT river.country_name, AVG(river.length) AS average_length FROM river GROUP BY river.country_name ORDER BY average_length DESC NULLS LAST;",geography,group_by,,postgres,"SELECT LENGTH, country_name FROM river GROUP BY LENGTH, country_name;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the total population in cities by country?,"SELECT city.country_name, SUM(city.population) AS total_population FROM city GROUP BY city.country_name ORDER BY total_population DESC NULLS LAST;",geography,group_by,,postgres,"SELECT city.country_name, SUM(city.population) AS total_population
FROM city
GROUP BY city.country_name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
Get the cities in the United States and their population,"SELECT city_name, population FROM city WHERE country_name ILIKE '%United States%';",geography,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,"SELECT city.city_name, city.population FROM city
JOIN state ON city.state_name  =  state.state_name
WHERE state.country_name ILIKE 'United States';",,,0,0,0,0,0,,0,,,,,,,,,,,False
What are the names and altitudes of the mountains in Nepal?,"SELECT mountain_name, mountain_altitude FROM mountain WHERE country_name ILIKE '%Nepal%';",geography,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,"SELECT mountain_name,  mountain_altitude FROM mountain WHERE country_name ILIKE 'Nepal';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the names and areas of the lakes in Michigan?,"SELECT lake_name, area FROM lake WHERE state_name ILIKE '%Michigan%';",geography,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,"SELECT lake_name,  area FROM lake WHERE state_name ILIKE 'Michigan';",,,1,1,0,0,0,,0,,,,,,,,,,,False
Which rivers traverse at least 3 cities/landmarks?,"SELECT river_name FROM river WHERE traverse LIKE '%,%,%';",geography,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,"SELECT DISTINCT river_name FROM river
WHERE LENGTH  >=  3;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Which states have fewer than a hundred thousand people?,SELECT state_name FROM state WHERE population < 100000;,geography,instruct,"
Follow the instructions below to generate the query:
Always filter names using ILIKE
",postgres,SELECT state_name FROM city WHERE population < 100000;,,,0,0,0,0,0,,0,,,,,,,,,,,False
"What are the highest mountains in meters, ordered from highest to lowest altitude?","SELECT mountain.mountain_name, mountain.mountain_altitude FROM mountain ORDER BY mountain.mountain_altitude DESC NULLS LAST;",geography,order_by,,postgres,SELECT mountain_name FROM mountain ORDER BY mountain_altitude DESC;,,,0,0,0,0,0,,0,,,,,,,,,,,False
"What are the longest rivers in meters, ordered from longest to shortest?","SELECT river.river_name, river.length FROM river ORDER BY river.length DESC NULLS LAST;",geography,order_by,,postgres,"SELECT river.river_name,  river.length FROM river ORDER BY river.length DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 5 cities with the highest population? Give both city names and the population.,"SELECT city.city_name, city.population FROM city ORDER BY city.population DESC NULLS LAST LIMIT 5;",geography,order_by,,postgres,"SELECT city_name,  population FROM city ORDER BY population DESC LIMIT 5;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"Which lakes have the largest areas in square kilometers, ordered from largest to smallest?","SELECT lake.lake_name, lake.area FROM lake ORDER BY lake.area DESC NULLS LAST;",geography,order_by,,postgres,SELECT lake_name FROM lake ORDER BY area DESC NULLS LAST;,,,0,0,0,0,0,,0,,,,,,,,,,,False
"Which states have the highest population density in people per square kilometer, ordered from highest to lowest?","SELECT state.state_name, state.density FROM state ORDER BY state.density DESC NULLS LAST;",geography,order_by,,postgres,SELECT state_name FROM state ORDER BY density DESC;,,,0,0,0,0,0,,0,,,,,,,,,,,False
Get the ratio of population per area for each state,"SELECT state_name, population / NULLIF(area, 0) AS population_density FROM state;",geography,ratio,,postgres,"SELECT state_name, population / NULLIF(area, 0) AS population_density_per_area
FROM state;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"How does the population of each city vary in relation to the population of its corresponding state? Return the city name, and the proportion of each city's population relative to the state.","SELECT city.city_name, CAST(city.population AS float) / NULLIF(state.population, 0) AS population_ratio FROM city JOIN state ON city.state_name = state.state_name ORDER BY population_ratio DESC NULLS LAST;",geography,ratio,,postgres,"SELECT city.city_name, 
       CAST(city.population AS FLOAT) / NULLIF(state.population, 0) AS population_ratio
FROM city
JOIN state ON city.state_name = state.state_name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the altitude of 'Mount Everest' to the altitude of 'Dhaulagiri'? Match strings exactly,"SELECT (CAST(everest.mountain_altitude AS FLOAT) / NULLIF(dhaulagiri.mountain_altitude, 0)) AS altitude_ratio FROM (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Mount Everest') AS everest, (SELECT mountain_altitude FROM mountain WHERE mountain_name = 'Dhaulagiri') AS dhaulagiri;",geography,ratio,,postgres,"SELECT CAST(everest.mountain_altitude AS FLOAT) / NULLIF(dhaulagiri.mountain_altitude, 0) AS ratio
FROM mountain AS everest
JOIN mountain AS dhaulagiri ON everest.country_name = dhaulagiri.country_name AND everest.state_name = dhaulagiri.state_name
WHERE everest.mountain_name ILIKE '%Everest%' AND dhaulagiri.mountain_name ILIKE '%Dhaulagiri%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the length of the Mississippi River to the length of the Rhine River?,"SELECT CAST((SELECT length FROM river WHERE LOWER(river_name) LIKE '%mississippi%') AS FLOAT) / NULLIF((SELECT length FROM river WHERE LOWER(river_name) LIKE '%rhine%'), 0) AS ratio ;",geography,ratio,,postgres,"SELECT CAST(lake_name_1.length AS FLOAT) / NULLIF(lake_name_2.length, 0) AS ratio
FROM lake AS lake_name_1
JOIN lake AS lake_name_2 ON lake_name_1.lake_name!= lake_name_2.lake_name
WHERE lake_name_1.lake_name IN ('Mississippi', 'Mississippi River') AND lake_name_2.lake_name IN ('Rhine', 'Rhine River');",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column lake_name_1.length does not exist
LINE 1: SELECT CAST(lake_name_1.length AS FLOAT) / NULLIF(lake_name_...
                    ^

[SQL: SELECT CAST(lake_name_1.length AS FLOAT) / NULLIF(lake_name_2.length, 0) AS ratio
FROM lake AS lake_name_1
JOIN lake AS lake_name_2 ON lake_name_1.lake_name!= lake_name_2.lake_name
WHERE lake_name_1.lake_name IN ('Mississippi', 'Mississippi River') AND lake_name_2.lake_name IN ('Rhine', 'Rhine River');]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the ratio of the population of the United States to the population of California?,"SELECT CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.country_name) LIKE '%united states%') AS FLOAT) / CAST(SUM(NULLIF(state.population, 0)) FILTER (WHERE LOWER(state.state_name) LIKE '%california%') AS FLOAT) AS population_ratio FROM state;",geography,ratio,,postgres,"SELECT CAST(SUM(t1.population) AS FLOAT) / NULLIF(SUM(t2.population), 0) AS population_ratio
FROM city AS t1
JOIN state AS t2 ON t1.state_name = t2.state_name
WHERE t1.country_name ILIKE '%United States%' AND t2.state_name ILIKE '%California%';",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the average length of rivers per country in countries with a lake?,"SELECT l.country_name, AVG(r.length) AS average_length FROM river r JOIN lake l ON r.country_name = l.country_name GROUP BY 1;",geography,table_join,,postgres,SELECT AVG(r.length) FROM river AS r JOIN lake AS l ON r.country_name  =  l.country_name;,,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the highest point in each state and what is the population density of that state?,"SELECT highlow.state_name, highlow.highest_point, state.density FROM highlow JOIN state ON highlow.state_name = state.state_name;",geography,table_join,,postgres,"SELECT h.state_name, h.highest_point, s.density FROM highlow h JOIN state s ON h.state_name = s.state_name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
Which countries have both lakes and rivers?,SELECT DISTINCT lake.country_name FROM lake JOIN river ON lake.country_name = river.country_name;,geography,table_join,,postgres,SELECT DISTINCT city.country_name FROM city JOIN lake ON city.country_name = lake.country_name JOIN river ON city.country_name = river.country_name;,,,0,0,0,0,0,,0,,,,,,,,,,,False
"Which lakes have a name that starts with ""Lake""? They should be located in states with an area greater than 1000 square kilometers.",SELECT lake.lake_name FROM lake JOIN state ON lake.state_name = state.state_name WHERE state.area > 1000 AND lake.lake_name ilike 'Lake%' ORDER BY lake.lake_name NULLS LAST;,geography,table_join,,postgres,SELECT lake_name FROM lake WHERE lake_name ILIKE 'Lake%' AND area > 1000;,,,0,0,0,0,0,,0,,,,,,,,,,,False
Which states border the state where lake ontario is?,SELECT border_info.border FROM border_info JOIN lake ON border_info.state_name = lake.state_name WHERE lake.lake_name ilike '%Ontario%';,geography,table_join,,postgres,SELECT border_info.state_name FROM border_info JOIN lake ON border_info.state_name = lake.state_name WHERE lake.state_name ILIKE '%Lake%';,,,0,0,0,0,0,,0,,,,,,,,,,,False
How many restaurants are there in each city? Order the results by the number of restaurants in descending order.,"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants FROM LOCATION GROUP BY location.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,group_by,,postgres,"SELECT L.CITY_NAME, COUNT(*) AS NUM_OF_RESTAURANTS FROM LOCATION AS L JOIN RESTAURANT AS R ON L.RESTAURANT_ID  =  R.ID GROUP BY L.CITY_NAME ORDER BY NUM_OF_RESTAURANTS DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many restaurants serve Italian food in each city?,"SELECT restaurant.city_name, COUNT(*) AS number_of_restaurants FROM restaurant WHERE restaurant.food_type ILIKE '%Italian%' GROUP BY restaurant.city_name ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,group_by,,postgres,"SELECT L.CITY_NAME, COUNT(*) AS NUM_RESTAURANTS
FROM LOCATION AS L
JOIN RESTAURANT AS R ON L.RESTAURANT_ID  =  R.ID
WHERE R.FOOD_TYPE  =  'Italian'
GROUP BY L.CITY_NAME;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average rating of restaurants serving each type of food?,"SELECT restaurant.food_type, AVG(restaurant.rating) AS average_rating FROM restaurant GROUP BY restaurant.food_type ORDER BY average_rating DESC NULLS LAST;",restaurants,group_by,,postgres,"SELECT restaurant.food_type, AVG(restaurant.rating) FROM restaurant GROUP BY restaurant.food_type;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total count of restaurants in each city?,"SELECT location.city_name, COUNT(DISTINCT location.restaurant_id) AS total_count FROM LOCATION GROUP BY location.city_name;",restaurants,group_by,,postgres,"SELECT L.CITY_NAME, COUNT(*) AS TOTAL_COUNT FROM LOCATION AS L JOIN RESTAURANT AS R ON L.RESTAURANT_ID  =  R.ID GROUP BY L.CITY_NAME;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of restaurants serving each type of food?,"SELECT restaurant.food_type, COUNT(DISTINCT restaurant.id) AS total_number_of_restaurants FROM restaurant GROUP BY restaurant.food_type;",restaurants,group_by,,postgres,"SELECT restaurant.food_type, COUNT(*) FROM restaurant GROUP BY restaurant.food_type;",,,0,1,0,0,0,,0,,,,,,,,,,,False
What are the names of the restaurants in Los Angeles that have a rating higher than 4?,SELECT DISTINCT restaurant.name FROM restaurant WHERE restaurant.city_name ILIKE '%Los Angeles%' AND restaurant.rating > 4 ORDER BY restaurant.name NULLS LAST;,restaurants,instruct,"
Follow the instructions below to generate the query:
Match city_name and food_type case-insensitively.
Match with ILIKE and percent sign for substring matching for all other string matches.
",postgres,"SELECT name FROM restaurant
JOIN LOCATION ON restaurant.city_name = location.city_name
WHERE LOWER(location.city_name) ILIKE '%los angeles%' AND rating > 4;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the names of the restaurants that serve Italian food?,SELECT restaurant.name FROM restaurant WHERE LOWER(restaurant.food_type) ILIKE '%italian%';,restaurants,instruct,"
Follow the instructions below to generate the query:
Match city_name and food_type case-insensitively.
Match with ILIKE and percent sign for substring matching for all other string matches.
",postgres,SELECT name FROM restaurant JOIN LOCATION ON restaurant.city_name = location.city_name WHERE LOWER(restaurant.food_type) ILIKE '%italian%';,,,1,1,0,0,0,,0,,,,,,,,,,,False
What's the name and food type of all the restaurants located on Market St in San Francisco?,"SELECT restaurant.name, restaurant.food_type FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE location.street_name ILIKE '%Market St%' AND location.city_name ILIKE '%San Francisco%';",restaurants,instruct,"
Follow the instructions below to generate the query:
Match city_name and food_type case-insensitively.
Match with ILIKE and percent sign for substring matching for all other string matches.
",postgres,"SELECT restaurant.name,  restaurant.food_type FROM restaurant JOIN LOCATION ON restaurant.city_name ILIKE location.city_name WHERE location.street_name ILIKE '%Market St%' AND location.city_name ILIKE '%San Francisco%';",,,0,0,0,0,0,,0,,,,,,,,,,,False
What's the name and rating of all the restaurants that have a rating greater than 4 and are located in the city of New York?,"SELECT restaurant.name, restaurant.rating FROM restaurant WHERE restaurant.rating > 4 AND restaurant.city_name ILIKE '%New York%';",restaurants,instruct,"
Follow the instructions below to generate the query:
Match city_name and food_type case-insensitively.
Match with ILIKE and percent sign for substring matching for all other string matches.
",postgres,"SELECT name,  rating FROM restaurant WHERE rating  >  4 AND city_name ILIKE '%New York%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
Which city has the highest-rated restaurant?,SELECT DISTINCT restaurant.city_name FROM restaurant WHERE rating=(SELECT MAX(rating) FROM restaurant);,restaurants,instruct,"
Follow the instructions below to generate the query:
Match city_name and food_type case-insensitively.
Match with ILIKE and percent sign for substring matching for all other string matches.
",postgres,SELECT DISTINCT L1.city_name FROM LOCATION AS L1 JOIN RESTAURANT AS R1 ON L1.restaurant_id  =  R1.id WHERE R1.rating  =  (SELECT MAX(rating) FROM restaurant) ORDER BY L1.city_name LIMIT 1;,,,1,1,0,0,0,,0,,,,,,,,,,,False
List the restaurants starting from the best ratings to the lowest,"SELECT {name, id}, rating FROM restaurant ORDER BY rating DESC;",restaurants,order_by,,postgres,"SELECT restaurant.name FROM restaurant ORDER BY rating DESC, restaurant.id ASC;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What are the names of the top 3 restaurants with the highest ratings?,SELECT restaurant.name FROM restaurant ORDER BY restaurant.rating DESC NULLS LAST LIMIT 3;,restaurants,order_by,,postgres,SELECT T1.name FROM restaurant AS T1 JOIN LOCATION AS T2 ON T1.restaurant_id  =  T2.restaurant_id ORDER BY T1.rating DESC LIMIT 3;,,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t1.restaurant_id does not exist
LINE 1: ...name FROM restaurant AS T1 JOIN LOCATION AS T2 ON T1.restaur...
                                                             ^
HINT:  Perhaps you meant to reference the column ""t2.restaurant_id"".

[SQL: SELECT T1.name FROM restaurant AS T1 JOIN LOCATION AS T2 ON T1.restaurant_id  =  T2.restaurant_id ORDER BY T1.rating DESC LIMIT 3;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the average rating of restaurants in each region? Order the results by the region name.,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name GROUP BY geographic.region ORDER BY geographic.region NULLS LAST;",restaurants,order_by,,postgres,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN LOCATION ON geographic.city_name = location.city_name JOIN RESTAURANT ON location.restaurant_id = restaurant.id GROUP BY geographic.region ORDER BY geographic.region;",,,1,1,0,0,0,,0,,,,,,,,,,,False
Which restaurants serve Italian cuisine or are located in New York? Order the results by the restaurant name.,SELECT name FROM restaurant WHERE food_type ILIKE '%Italian%' OR city_name ILIKE '%New York%' ORDER BY name NULLS LAST;,restaurants,order_by,,postgres,"SELECT restaurant.name FROM restaurant
JOIN LOCATION ON restaurant.id = location.restaurant_id
WHERE restaurant.food_type ILIKE '%Italian%' OR location.city_name ILIKE '%New York%'
ORDER BY restaurant.name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
Which street has the most number of restaurants?,SELECT street_name FROM location GROUP BY street_name ORDER BY COUNT(restaurant_id) DESC LIMIT 1;,restaurants,order_by,,postgres,SELECT street_name FROM LOCATION GROUP BY street_name ORDER BY COUNT(*) DESC LIMIT 1;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of Italian restaurants out of all restaurants in Los Angeles?,"SELECT CAST(COUNT(CASE WHEN food_type ILIKE '%Italian%' THEN 1 END) AS FLOAT) / NULLIF(COUNT(food_type), 0) AS ratio FROM restaurant WHERE city_name ILIKE '%Los Angeles%';",restaurants,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN food_type ILIKE '%Italian%' THEN 1 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM LOCATION JOIN RESTAURANT ON LOCATION.RESTAURANT_ID = RESTAURANT.ID WHERE LOWER(LOCATION.CITY_NAME) ILIKE '%Los Angeles%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of restaurants serving vegan food to restaurants serving non-vegan food in San Francisco? Match food_type case insensitively,"SELECT CAST(SUM(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant WHERE LOWER(restaurant.city_name) ILIKE '%san francisco%';",restaurants,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN LOWER(restaurant.food_type) LIKE '%vegan%' THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN LOWER(restaurant.food_type) NOT LIKE '%vegan%' THEN 1 END), 0) AS ratio FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE LOWER(location.city_name) ILIKE '%san francisco%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of restaurants with a rating above 4 to restaurants with a rating below 4 in New York?,"SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio FROM restaurant WHERE city_name ILIKE 'New York';",restaurants,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN rating > 4 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4 THEN 1 END), 0) AS ratio
FROM restaurant
WHERE city_name ILIKE 'New York';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of restaurants with a rating above 4.0 to restaurants with a rating below 4.0 overall?,"SELECT CAST(SUM(CASE WHEN restaurant.rating > 4.0 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN restaurant.rating < 4.0 THEN 1 ELSE 0 END), 0) AS ratio FROM restaurant;",restaurants,ratio,,postgres,"SELECT 
  CAST(COUNT(CASE WHEN rating > 4.0 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN rating < 4.0 THEN 1 END), 0) AS ratio
FROM 
  restaurant;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of restaurants with rating > 4.5 to the total number of restaurants in the database.,"SELECT COUNT(*)::float / NULLIF((SELECT COUNT(*) FROM restaurant), 0) AS rating_ratio FROM restaurant WHERE rating > 4.5;",restaurants,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN rating > 4.5 THEN 1 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM restaurant;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many restaurants are there in each region?,"SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;SELECT geographic.region, COUNT(DISTINCT restaurant.id) AS number_of_restaurants FROM geographic LEFT JOIN restaurant ON geographic.city_name = restaurant.city_name GROUP BY geographic.region ORDER BY number_of_restaurants DESC;",restaurants,table_join,,postgres,"SELECT geographic.region, COUNT(DISTINCT location.restaurant_id) AS number_of_restaurants
FROM geographic
JOIN LOCATION ON geographic.city_name = location.city_name
GROUP BY geographic.region;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many restaurants serve Italian food in each region?,"SELECT geographic.region, COUNT(restaurant.id) AS number_of_restaurants FROM restaurant JOIN geographic ON restaurant.city_name = geographic.city_name WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC NULLS LAST;",restaurants,table_join,,postgres,"SELECT geographic.region, COUNT(*) AS number_of_restaurants FROM geographic JOIN LOCATION ON geographic.city_name = location.city_name JOIN RESTAURANT ON location.restaurant_id = restaurant.id WHERE LOWER(restaurant.food_type) LIKE '%italian%' GROUP BY geographic.region ORDER BY number_of_restaurants DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What cities have more than one restaurants with the same name, and how many of them are there? Return the city name, restaurant name, and restaurant count","SELECT r.city_name, r.name, COUNT(r.id) AS restaurant_count FROM restaurant r GROUP BY r.city_name, r.name HAVING COUNT(r.id) > 1;",restaurants,table_join,,postgres,"SELECT T1.city_name,  T2.name,  COUNT(*) FROM geographic AS T1 JOIN LOCATION AS T2 ON T1.city_name  =  T2.city_name GROUP BY T1.city_name,  T2.name HAVING COUNT(*)  >  1;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t2.name does not exist
LINE 1: SELECT T1.city_name,  T2.name,  COUNT(*) FROM geographic AS ...
                              ^

[SQL: SELECT T1.city_name,  T2.name,  COUNT(*) FROM geographic AS T1 JOIN LOCATION AS T2 ON T1.city_name  =  T2.city_name GROUP BY T1.city_name,  T2.name HAVING COUNT(*)  >  1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the average rating of restaurants in each region?,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN restaurant ON geographic.city_name=restaurant.city_name GROUP BY 1;",restaurants,table_join,,postgres,"SELECT geographic.region, AVG(restaurant.rating) AS average_rating FROM geographic JOIN LOCATION ON geographic.city_name = location.city_name JOIN RESTAURANT ON location.restaurant_id = restaurant.id GROUP BY geographic.region;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average rating of restaurants that serve Mexican food in each city?,"SELECT location.city_name, AVG(restaurant.rating) AS average_rating FROM restaurant JOIN LOCATION ON restaurant.id = location.restaurant_id WHERE LOWER(restaurant.food_type) LIKE '%mexican%' GROUP BY location.city_name;",restaurants,table_join,,postgres,"SELECT T1.city_name, AVG(T2.rating) AS average_rating FROM geographic AS T1 JOIN LOCATION AS T2 ON T1.city_name  =  T2.city_name WHERE T2.food_type  =  'Mexican' GROUP BY T1.city_name;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t2.rating does not exist
LINE 1: SELECT T1.city_name, AVG(T2.rating) AS average_rating FROM g...
                                 ^

[SQL: SELECT T1.city_name, AVG(T2.rating) AS average_rating FROM geographic AS T1 JOIN LOCATION AS T2 ON T1.city_name  =  T2.city_name WHERE T2.food_type  =  'Mexican' GROUP BY T1.city_name;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
Give me the total number of papers published in the first 12 months of 2019.,SELECT count(*) AS total_papers FROM paper WHERE YEAR = 2019;,scholar,date_functions,,postgres,"SELECT count(*) FROM paper
WHERE YEAR = 2019 AND MONTH >= 1 AND MONTH <= 12;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""month"" does not exist
LINE 2: WHERE YEAR = 2019 AND MONTH >= 1 AND MONTH <= 12;
                              ^

[SQL: SELECT count(*) FROM paper
WHERE YEAR = 2019 AND MONTH >= 1 AND MONTH <= 12;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How many authors have written a paper that was published 1 year or longer before today's date?,SELECT count(DISTINCT w.authorid) AS num_authors FROM paper p JOIN writes w ON p.paperid = w.paperid WHERE p.year < extract(YEAR FROM CURRENT_DATE - interval '1 year');,scholar,date_functions,,postgres,"SELECT count(*) FROM writes AS w
JOIN paper AS p ON w.paperid  =  p.paperid
WHERE p.year  <   (extract(YEAR FROM CURRENT_DATE) - 1);",,,0,0,0,0,0,,0,,,,,,,,,,,False
How many keyphrases are associated with papers published between 2020 and 2035?,SELECT count(DISTINCT pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid WHERE p.year >= 2020 AND p.year <= 2035 ;,scholar,date_functions,,postgres,"SELECT count(*) FROM paperkeyphrase pk
JOIN paper p ON pk.paperid  =  p.paperid
WHERE p.year   BETWEEN 2020 AND 2035;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"On average, how many papers per month were published in the whole of 2020?",SELECT cast(count(*) AS float)/ 12 AS average_papers_per_month FROM paper WHERE YEAR = 2020;,scholar,date_functions,,postgres,"SELECT 
  date_trunc('month', p.publication_date) AS month, 
  count(*) AS num_papers
FROM 
  paper AS p
WHERE _year = 2020
GROUP BY 
  month
ORDER BY 
  month NULLS LAST;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column p.publication_date does not exist
LINE 2:   date_trunc('month', p.publication_date) AS month, 
                              ^

[SQL: SELECT 
  date_trunc('month', p.publication_date) AS month, 
  count(*) AS num_papers
FROM 
  paper AS p
WHERE _year = 2020
GROUP BY 
  month
ORDER BY 
  month NULLS LAST;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
What's the number of papers published per year excluding those published in the year that is 6 years before 2025?,"SELECT YEAR, count(*) AS num_papers FROM paper WHERE YEAR != 2025 - 6 GROUP BY YEAR ORDER BY YEAR;",scholar,date_functions,,postgres,"SELECT YEAR, COUNT(*) AS num_papers
FROM paper
WHERE YEAR < 2025 - 6
GROUP BY YEAR
ORDER BY YEAR DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many authors have published more than 2 papers?,SELECT COUNT(*) AS number_of_authors FROM (SELECT writes.authorid FROM writes GROUP BY writes.authorid HAVING COUNT(writes.paperid) > 2) AS subquery;,scholar,group_by,,postgres,"SELECT count(*) FROM (
  SELECT writes.authorid FROM writes
  JOIN paper ON writes.paperid = paper.paperid
  GROUP BY writes.authorid
  HAVING count(*) > 2
) AS subquery;",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many keyphrases are associated with each paper?,"SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY keyphrase_count DESC NULLS LAST;SELECT p.title, COUNT(pk.keyphraseid) AS num_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid GROUP BY p.title ORDER BY num_keyphrases DESC NULLS LAST;",scholar,group_by,,postgres,"SELECT pk.keyphraseid, pk.keyphrasename, COUNT(*) AS number_of_papers
FROM paperkeyphrase AS pkp
JOIN paper AS p ON pkp.paperid  =  p.paperid
JOIN keyphrase AS pk ON pkp.keyphraseid  =  pk.keyphraseid
GROUP BY pk.keyphraseid, pk.keyphrasename;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the total number of papers associated with each dataset?,"SELECT paperdataset.datasetid, COUNT(DISTINCT paperdataset.paperid) AS total_papers FROM paperdataset GROUP BY paperdataset.datasetid;SELECT dataset.datasetname, COUNT(paperdataset.paperid) AS total_papers FROM paperdataset JOIN dataset ON paperdataset.datasetid = dataset.datasetid GROUP BY dataset.datasetname;",scholar,group_by,,postgres,"SELECT dataset.datasetname,  COUNT(paperdataset.datasetid) AS total_papers FROM dataset JOIN paperdataset ON dataset.datasetid  =  paperdataset.datasetid GROUP BY dataset.datasetname;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of papers published in each year?,"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year;",scholar,group_by,,postgres,"SELECT paper.year, count(*) FROM paper GROUP BY paper.year;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of papers published per year?,"SELECT paper.year, COUNT(paper.paperid) AS total_papers FROM paper GROUP BY paper.year ORDER BY paper.year NULLS LAST;",scholar,group_by,,postgres,"SELECT paper.year, count(*) FROM paper GROUP BY paper.year ORDER BY paper.year;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"How many authors wrote papers that were published in the journal ""Science"" in the year 2020?",SELECT COUNT(DISTINCT writes.authorid) AS number_of_authors FROM writes JOIN paper ON writes.paperid = paper.paperid JOIN journal ON paper.journalid = journal.journalid WHERE journal.journalname ILIKE '%Science%' AND paper.year = 2020;,scholar,instruct,"
Follow the instructions below to generate the query:
Filter paper names using exact matches.
Filter keyphrases and journal names with case-insensitive matching.
",postgres,"SELECT count(*) FROM writes AS w
JOIN paper AS p ON w.paperid  =  p.paperid
JOIN journal AS j ON p.journalid  =  j.journalid
WHERE j.journalname  =  ""Science"" AND p.year  =  ""2020"";",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""Science"" does not exist
LINE 4: WHERE j.journalname  =  ""Science"" AND p.year  =  ""2020"";
                                ^

[SQL: SELECT count(*) FROM writes AS w
JOIN paper AS p ON w.paperid  =  p.paperid
JOIN journal AS j ON p.journalid  =  j.journalid
WHERE j.journalname  =  ""Science"" AND p.year  =  ""2020"";]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"How many papers are associated with the keyphrase ""machine learning"" and were published in the journal named ""IEEE Transactions on Pattern Analysis and Machine Intelligence""?",SELECT COUNT(DISTINCT paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%machine learning%' AND journal.journalname = 'IEEE Transactions on Pattern Analysis and Machine Intelligence';,scholar,instruct,"
Follow the instructions below to generate the query:
Filter paper names, journal names, using exact matches.
Filter keyphrases with case-insensitive matching.
",postgres,"SELECT count(*) FROM paper
JOIN paperdataset ON paper.paperid = paperdataset.paperid
JOIN paperfield ON paper.paperid = paperfield.paperid
JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid
JOIN writes ON paper.paperid = writes.paperid
JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid
JOIN journal ON paper.journalid = journal.journalid
WHERE LOWER(paper.title) ILIKE '%machine learning%' AND journal.journalname ILIKE '%IEEE Transactions on Pattern Analysis and Machine Intelligence%';",,,0,0,0,0,0,,0,,,,,,,,,,,False
"How many papers were published in the journal ""nature"" in the year 2020?",SELECT COUNT(paper.paperid) FROM paper JOIN journal ON paper.journalid = journal.journalid WHERE paper.year = 2020 AND journal.journalname ILIKE '%nature%';,scholar,instruct,"
Follow the instructions below to generate the query:
Filter strings with case-insensitive matching
",postgres,"SELECT count(*) FROM paper
JOIN journal ON paper.journalid = journal.journalid
WHERE paper.year = 2020 AND journal.journalname ilike '%nature%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the names of the authors who wrote the paper with the title ""The Effects of Climate Change on Agriculture""?",SELECT author.authorname FROM author JOIN writes ON author.authorid = writes.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title = 'The Effects of Climate Change on Agriculture';,scholar,instruct,"
Follow the instructions below to generate the query:
Always filter strings with an exact match
",postgres,SELECT DISTINCT authorname FROM writes JOIN author ON writes.authorid = author.authorid JOIN paper ON writes.paperid = paper.paperid WHERE paper.title ILIKE '%The Effects of Climate Change on Agriculture%';,,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the name of the venue where the paper with paper ID 2 was published, and how many papers were published in total in that venue?","SELECT venue.venuename, COUNT(DISTINCT paper.paperid) FROM paper JOIN venue ON paper.venueid = venue.venueid WHERE paper.venueid = (SELECT venueid FROM paper WHERE paperid = 2 ) GROUP BY venue.venuename;",scholar,instruct,"
Follow the instructions below to generate the query:
Always filter strings using ILIKE
",postgres,"SELECT v.venuename,  count(*) FROM paper p
JOIN venue v ON p.venueid  =  v.venueid
WHERE p.paperid  = 2;",,"QUERY EXECUTION ERROR: (psycopg2.errors.GroupingError) column ""v.venuename"" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT v.venuename,  count(*) FROM paper p
               ^

[SQL: SELECT v.venuename,  count(*) FROM paper p
JOIN venue v ON p.venueid  =  v.venueid
WHERE p.paperid  = 2;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"For each paper that cites other papers, how many other papers does it cite? Sort by the number of papers cited in descending order","SELECT cite.citingpaperid, COUNT(*) AS citation_count FROM cite GROUP BY cite.citingpaperid ORDER BY citation_count DESC NULLS LAST;SELECT p.paperid, p.numciting FROM paper p WHERE p.numciting > 0 ORDER BY p.numciting DESC;SELECT p.title, COUNT(c.citedpaperid) AS num_cited_papers FROM paper p JOIN cite c ON p.paperid = c.citingpaperid GROUP BY p.title ORDER BY num_cited_papers DESC;",scholar,order_by,,postgres,"SELECT citingpaperid, count(*) AS citation_count FROM cite GROUP BY citingpaperid ORDER BY citation_count DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the names of the journals in the database, ordered by the length of the journal name from shortest to longest?",SELECT journal.journalname FROM journal ORDER BY LENGTH(journal.journalname) ASC NULLS LAST;,scholar,order_by,,postgres,SELECT journalname FROM journal ORDER BY LENGTH(journalname) ASC;,,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the titles of the papers published in the year 2020, ordered alphabetically?",SELECT paper.title FROM paper WHERE paper.year = 2020 ORDER BY paper.title ASC NULLS LAST;,scholar,order_by,,postgres,SELECT title FROM paper WHERE YEAR = 2020 ORDER BY title ASC;,,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of keyphrases associated with each paper, ordered by the paper ID in ascending order?","SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS total_keyphrases FROM paperkeyphrase GROUP BY paperkeyphrase.paperid ORDER BY paperkeyphrase.paperid ASC NULLS LAST;",scholar,order_by,,postgres,"SELECT pk.paperid, COUNT(*) AS total_keyphrases FROM paper p JOIN paperkeyphrase pk ON p.paperid = pk.paperid GROUP BY pk.paperid ORDER BY pk.paperid ASC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"Which papers have the highest number of authors, ordered by the number of authors in descending order?","SELECT {paper.paperid, paper.title}, COUNT(DISTINCT writes.authorid) AS num_authors FROM paper JOIN writes ON paper.paperid = writes.paperid GROUP BY {} ORDER BY num_authors DESC;",scholar,order_by,,postgres,"SELECT p.paperid, p.title, COUNT(DISTINCT w.authorid) AS num_authors
FROM paper p
JOIN writes w ON p.paperid = w.paperid
GROUP BY p.paperid, p.title
ORDER BY num_authors DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the proportion of papers that belong to more than 1 dataset to papers that belong to 1 dataset?,"SELECT CAST(COUNT(CASE WHEN dataset_count > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN dataset_count = 1 THEN 1 END), 0) AS ratio FROM (SELECT paperdataset.paperid, COUNT(paperdataset.datasetid) AS dataset_count FROM paperdataset GROUP BY paperdataset.paperid) AS subquery;",scholar,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN numciting > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN numciting + numcitedby > 1 THEN 1 END), 0) AS ratio
FROM paper;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of authors who have written 3 or more papers to authors who have written less than 3 papers?,"SELECT CAST(COUNT(DISTINCT CASE WHEN paper_count >= 3 THEN subquery.authorid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN paper_count < 3 THEN subquery.authorid END), 0) AS ratio FROM (SELECT writes.authorid, COUNT(writes.paperid) AS paper_count FROM writes GROUP BY writes.authorid) AS subquery;",scholar,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN numciting >= 3 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN numciting < 3 THEN 1 END), 0) AS ratio
FROM paper;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of papers published in the year 2020 to the total number of papers in the database?,"SELECT CAST(COUNT(CASE WHEN paper.year = 2020 THEN 1 END) AS FLOAT) / NULLIF(COUNT(paper.paperid), 0) AS ratio FROM paper;",scholar,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN YEAR = 2020 THEN 1 END) AS FLOAT) / NULLIF(COUNT(*), 0) AS ratio FROM paper;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of papers that have been cited by 2 or more papers to papers that have been cited by less than 2 papers?,"SELECT CAST(COUNT(CASE WHEN paper.numcitedby > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN paper.numcitedby < 2 THEN 1 END), 0) AS ratio FROM paper;",scholar,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN numciting  >=  2 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN numcitedby  <  2 THEN 1 END), 0) AS ratio FROM paper;",,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the ratio of papers that have more than 1 keyphrases to papers that have 1 keyphrase?,"SELECT CAST(COUNT(DISTINCT CASE WHEN keyphrase_count > 1 THEN subquery.paperid END) AS FLOAT) / NULLIF(COUNT(DISTINCT CASE WHEN keyphrase_count =1 THEN subquery.paperid END), 0) AS ratio FROM (SELECT paperkeyphrase.paperid, COUNT(paperkeyphrase.keyphraseid) AS keyphrase_count FROM paperkeyphrase GROUP BY paperkeyphrase.paperid) AS subquery;",scholar,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN numciting > 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN numciting = 1 THEN 1 END), 0) AS ratio
FROM paper;",,,0,0,0,0,0,,0,,,,,,,,,,,False
"How many papers cite each paper in the dataset named ""COVID-19 Research""?","SELECT paperdataset.paperid, COUNT(cite.citedpaperid) AS citation_count FROM paperdataset JOIN cite ON paperdataset.paperid = cite.citedpaperid WHERE paperdataset.datasetid = (SELECT datasetid FROM dataset WHERE datasetname ILIKE '%COVID-19 Research%') GROUP BY paperdataset.paperid ORDER BY citation_count DESC;SELECT p.title, COUNT(c.citingpaperid) AS num_citing_papers FROM paper p JOIN paperdataset pd ON p.paperid = pd.paperid JOIN cite c ON p.paperid = c.citedpaperid JOIN dataset d ON pd.datasetid = d.datasetid WHERE d.datasetname = 'COVID-19 Research' GROUP BY p.title ORDER BY num_citing_papers DESC NULLS LAST;",scholar,table_join,,postgres,"SELECT cite.citingpaperid, COUNT(*) AS citation_count FROM cite
JOIN paper ON cite.citingpaperid = paper.paperid
JOIN paperdataset ON paper.paperid = paperdataset.paperid
JOIN dataset ON paperdataset.datasetid = dataset.datasetid
WHERE dataset.datasetname ILIKE '%COVID-19 Research%'
GROUP BY cite.citingpaperid
ORDER BY citation_count DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of papers published in each journal, ordered by the journal name?","SELECT journal.journalname, COUNT(DISTINCT paper.paperid) AS total_papers FROM paper JOIN journal ON paper.journalid = journal.journalid GROUP BY journal.journalname ORDER BY journal.journalname NULLS LAST;",scholar,table_join,,postgres,"SELECT journal.journalname,  count(paper.paperid) FROM paper 
JOIN journal ON paper.journalid  =  journal.journalid 
GROUP BY journal.journalname 
ORDER BY journal.journalname;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of unique keyphrases associated with papers published in the journal with ""IEEE Transactions"" in its name?",SELECT COUNT(DISTINCT paperkeyphrase.keyphraseid) AS total_keyphrases FROM paper JOIN journal ON paper.journalid = journal.journalid JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid WHERE journal.journalname ILIKE '%IEEE Transactions%';,scholar,table_join,,postgres,"SELECT count(DISTINCT pk.keyphraseid) FROM paper p 
JOIN paperkeyphrase pk ON p.paperid  =  pk.paperid 
JOIN writes w ON p.paperid  =  w.paperid 
JOIN author a ON w.authorid  =  a.authorid 
JOIN cite c ON p.paperid  =  c.citingpaperid 
JOIN paperdataset pd ON c.citingpaperid  =  pd.paperid 
JOIN journal j ON p.journalid  =  j.journalid 
WHERE j.journalname ILIKE '%IEEE Transactions%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
"Which authors have published the most papers, ordered by the number of papers they have published in descending order?","SELECT {author.authorname, author.authorid}, COUNT(DISTINCT writes.paperid) AS number_of_papers FROM author JOIN writes ON author.authorid = writes.authorid GROUP BY {} ORDER BY number_of_papers DESC NULLS LAST;",scholar,table_join,,postgres,"SELECT T1.authorname,  COUNT(*) AS num_papers FROM writes AS T1 JOIN paper AS T2 ON T1.paperid  =  T2.paperid GROUP BY T1.authorname ORDER BY num_papers DESC;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column t1.authorname does not exist
LINE 1: SELECT T1.authorname,  COUNT(*) AS num_papers FROM writes AS...
               ^

[SQL: SELECT T1.authorname,  COUNT(*) AS num_papers FROM writes AS T1 JOIN paper AS T2 ON T1.paperid  =  T2.paperid GROUP BY T1.authorname ORDER BY num_papers DESC;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"Which papers are associated with the keyphrase ""Machine Learning""?","SELECT {paper.title,paper.paperid} FROM paper JOIN paperkeyphrase ON paper.paperid = paperkeyphrase.paperid JOIN keyphrase ON paperkeyphrase.keyphraseid = keyphrase.keyphraseid WHERE keyphrase.keyphrasename ILIKE '%Machine Learning%';",scholar,table_join,,postgres,"SELECT p.title FROM paper AS p
JOIN paperkeyphrase AS pk ON p.paperid = pk.paperid
JOIN keyphrase AS k ON pk.keyphraseid = k.keyphraseid
WHERE k.keyphrasename ILIKE '%Machine Learning%';",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many months between June 2021 and December 2021 had reviews?,SELECT COUNT(DISTINCT MONTH) AS num_months FROM review WHERE YEAR = 2021 AND CASE MONTH WHEN 'January' THEN 1 WHEN 'February' THEN 2 WHEN 'March' THEN 3 WHEN 'April' THEN 4 WHEN 'May' THEN 5 WHEN 'June' THEN 6 WHEN 'July' THEN 7 WHEN 'August' THEN 8 WHEN 'September' THEN 9 WHEN 'October' THEN 10 WHEN 'November' THEN 11 WHEN 'December' THEN 12 END BETWEEN 6 AND 12;,yelp,date_functions,,postgres,"SELECT count(*) FROM review AS t1
JOIN tip AS t2 ON t1.business_id  =  t2.business_id
WHERE t2.year  =  '2021' AND t2.month  =  'June'
INTERSECT
SELECT count(*) FROM review AS t1
JOIN tip AS t2 ON t1.business_id  =  t2.business_id
WHERE t2.year  =  '2021' AND t2.month  =  'December';",,,1,1,0,0,0,,0,,,,,,,,,,,False
How many reviews were there 2 months before the review with id 3?,SELECT count(*) AS review_count FROM review WHERE (cast(review.year AS text) || '-' || review.month || '-01')::date = (SELECT (cast(r.year AS text) || '-' || r.month || '-01')::date - interval '2 months' FROM review r WHERE r.rid = 3) ;,yelp,date_functions,,postgres,"SELECT count(*) FROM review AS t1
JOIN review AS t2 ON t1.business_id = t2.business_id
WHERE t1.rid!= 3 AND t2.month  <= 'January';",,,0,0,0,0,0,,0,,,,,,,,,,,False
How many reviews were written for businesses located in California in the last 1000 months?,"SELECT count(*) AS review_count FROM review r JOIN business b ON r.business_id = b.business_id WHERE b.state = 'CA' AND (r.year * 12 + extract(MONTH FROM to_date(r.month, 'Month'))) >= (extract(YEAR FROM CURRENT_DATE) * 12 + extract(MONTH FROM CURRENT_DATE) - 1000) ;",yelp,date_functions,,postgres,SELECT count(*) FROM review AS T1 JOIN business AS T2 ON T1.business_id  =  T2.business_id WHERE T2.state  =  'CA' AND T1.year  <  1000;,,,0,0,0,0,0,,0,,,,,,,,,,,False
What is the total number of check-ins on the 2 days before Saturday?,"SELECT sum(COUNT) AS total_checkins FROM checkin WHERE DAY IN ('Thursday', 'Friday') ;",yelp,date_functions,,postgres,SELECT sum(count) FROM checkin WHERE DAY <> 'Saturday';,,,0,0,0,0,0,,0,,,,,,,,,,,False
What was the message that came with the tip made exactly 2 months after March 2021?,SELECT text AS message FROM tip WHERE MONTH ILIKE '%May%' AND YEAR = 2021 LIMIT 1;,yelp,date_functions,,postgres,SELECT text FROM tip WHERE MONTH ILIKE '%May%' AND YEAR = 2021 LIMIT 1;,,,1,1,0,0,0,,0,,,,,,,,,,,False
How many check-ins occurred on each day of the week?,"SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by,,postgres,"SELECT DISTINCT checkin.day, COUNT(*) AS checkin_count FROM checkin JOIN business ON checkin.business_id = business.business_id GROUP BY checkin.day ORDER BY checkin_count DESC;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Return the name and average rating for each business in new york,"SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%NEW YORK%' GROUP BY business.name;",yelp,group_by,,postgres,"SELECT 
  business.name, 
  avg(review.rating) AS average_rating
FROM 
  business
JOIN 
  review ON business.business_id = review.business_id
WHERE 
  business.city  =  'New York'
GROUP BY 
  business.name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total count of check-ins for each business id?,"SELECT checkin.business_id, SUM(checkin.count) AS total_checkins FROM checkin GROUP BY checkin.business_id ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by,,postgres,"SELECT checkin.business_id, COUNT(*) AS total_checkins FROM checkin GROUP BY checkin.business_id;",,,0,0,0,0,0,,0,,,,,,,,,,,False
"What is the total number of check-ins for each day of the week for the business with ID ""abc123""?","SELECT checkin.day, SUM(checkin.count) AS total_checkins FROM checkin WHERE checkin.business_id = 'abc123' GROUP BY checkin.day ORDER BY total_checkins DESC NULLS LAST;",yelp,group_by,,postgres,"SELECT checkin.day, sum(checkin.count) FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.business_id = 'abc123';",,"QUERY EXECUTION ERROR: (psycopg2.errors.GroupingError) column ""checkin.day"" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT checkin.day, sum(checkin.count) FROM checkin JOIN bus...
               ^

[SQL: SELECT checkin.day, sum(checkin.count) FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.business_id = 'abc123';]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"Which neighbourhoods have the highest number of businesses, and how many businesses are located in each neighbourhood?","SELECT {neighbourhood.neighbourhood_name, neighbourhood.id}, COUNT(DISTINCT neighbourhood.business_id) AS business_count FROM neighbourhood GROUP BY {} ORDER BY business_count DESC NULLS LAST;",yelp,group_by,,postgres,"SELECT neighbourhood_name, COUNT(*) AS business_count FROM neighbourhood
JOIN business ON neighbourhood.business_id = business.business_id
GROUP BY neighbourhood_name
ORDER BY business_count DESC
LIMIT 1;",,,0,0,0,0,0,,0,,,,,,,,,,,False
How many check-ins occurred on Mondays at businesses in the state of California?,SELECT SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' AND checkin.day ILIKE '%Monday%';,yelp,instruct,"
Follow the instructions below to generate the query:
Filter strings of users, city, address, business.name using ILIKE with wildcards.
Filter strings of state using exact upper case matches.
Assume the rating of a business to be its average rating, and compute it before computing other aggregates on it.
Always truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.

",postgres,"SELECT count(*) FROM checkin AS t1
JOIN business AS t2 ON t1.business_id  =  t2.business_id
JOIN neighbourhood AS t3 ON t2.business_id  =  t3.business_id
JOIN category AS t4 ON t2.business_id  =  t4.business_id
WHERE t1.day  =  'Monday' AND t2.state  =  'CA';",,,0,0,0,0,0,,0,,,,,,,,,,,False
"How many reviews were posted by users with the name ""Sarah Williams"" in the month of April 2021?",SELECT COUNT(*) FROM review JOIN users ON review.user_id = users.user_id WHERE users.name ILIKE '%Sarah Williams%' AND review.month = 'April' AND review.year = 2021;,yelp,instruct,"
Follow the instructions below to generate the query:
Filter strings of users, city, address, business.name using ILIKE with wildcards.
Filter strings of state using exact upper case matches.
Assume the rating of a business to be its average rating, and compute it before computing other aggregates on it.
Always truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.

",postgres,"SELECT count(*) FROM review AS T1 JOIN users AS T2 ON T1.user_id  =  T2.user_id WHERE T2.name  =  ""Sarah Williams"" AND T1.month  =  ""April"" AND T1.year  =  ""2021"";",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""Sarah Williams"" does not exist
LINE 1: ...T2 ON T1.user_id  =  T2.user_id WHERE T2.name  =  ""Sarah Wil...
                                                             ^

[SQL: SELECT count(*) FROM review AS T1 JOIN users AS T2 ON T1.user_id  =  T2.user_id WHERE T2.name  =  ""Sarah Williams"" AND T1.month  =  ""April"" AND T1.year  =  ""2021"";]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
How many reviews were posted for each business id in the year 2021?,"SELECT review.business_id, COUNT(*) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.business_id ORDER BY review_count DESC NULLS LAST;",yelp,instruct,"
Follow the instructions below to generate the query:
Filter strings of users, city, address, business.name using ILIKE with wildcards.
Filter strings of state using exact upper case matches.
Assume the rating of a business to be its average rating, and compute it before computing other aggregates on it.
Always truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.

",postgres,"SELECT business.business_id, COUNT(*) AS review_count
FROM business
JOIN review ON business.business_id = review.business_id
WHERE review.year = 2021
GROUP BY business.business_id;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the average rating of businesses in the city of San Francisco?,"SELECT AVG(sf.average_rating) AS sf_average_rating FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE LOWER(business.city) ILIKE '%san francisco%' GROUP BY business.business_id) AS sf;",yelp,instruct,"
Follow the instructions below to generate the query:
Filter strings of users, city, address, business.name using ILIKE with wildcards.
Filter strings of state using exact upper case matches.
The rating of businesses in a city refers to the average rating of the businesses in that city.
I.e., you must compute the average rating of each business before computing the average rating of businesses in the city.
Always truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.

",postgres,SELECT avg(t2.rating) FROM business AS t1 JOIN review AS t2 ON t1.business_id  =  t2.business_id WHERE t1.city  =  'San Francisco';,,,0,0,0,0,0,,0,,,,,,,,,,,False
"What is the total number of reviews posted in the year 2021 for businesses in the category ""Cafe""?",SELECT COUNT(review.rid) AS total_reviews FROM review JOIN category ON review.business_id = category.business_id WHERE review.year = 2021 AND category.category_name ILIKE '%Cafe%';,yelp,instruct,"
Follow the instructions below to generate the query:
Filter strings of users, city, address, business.name using ILIKE with wildcards.
Filter strings of state using exact upper case matches.
Assume the rating of a business to be its average rating, and compute it before computing other aggregates on it.
Always truncate dates in the question to its current month and year (if applicable) before filtering on `review.year` and `review.month`.

",postgres,"SELECT count(*) FROM review AS t1
JOIN business AS t2 ON t1.business_id  =  t2.business_id
JOIN category AS t3 ON t2.business_id  =  t3.business_id
WHERE t1.year  = 2021 AND t3.category_name  =  'Cafe';",,,1,1,0,0,0,,0,,,,,,,,,,,False
"How many reviews were posted in each month of the year 2021, ordered by the month?","SELECT review.month, COUNT(review.rid) AS review_count FROM review WHERE review.year = 2021 GROUP BY review.month ORDER BY TO_DATE(review.month, 'Month') NULLS LAST;",yelp,order_by,,postgres,"SELECT MONTH, COUNT(*) AS review_count FROM review
WHERE YEAR = 2021
GROUP BY MONTH
ORDER BY MONTH;",,,0,0,0,0,0,,0,,,,,,,,,,,False
Please provide a list of business names in New York and their average ratings ordered by the highest average rating first.,"SELECT business.name, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city ILIKE '%New York%' GROUP BY business.name, business.business_id ORDER BY average_rating DESC NULLS LAST;",yelp,order_by,,postgres,"SELECT business.name, avg(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id WHERE business.city  =  'New York' GROUP BY business.name ORDER BY average_rating DESC NULLS LAST;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What are the names of the businesses in the database, ordered alphabetically?",SELECT business.name FROM business ORDER BY business.name ASC NULLS LAST;,yelp,order_by,,postgres,SELECT name FROM business ORDER BY name ASC;,,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 3 businesses in terms of review count?,"SELECT {business.name, business.business_id, business.bid}, business.review_count FROM business ORDER BY business.review_count DESC NULLS LAST LIMIT 3;",yelp,order_by,,postgres,"SELECT business.business_id, business.name, business.review_count FROM business ORDER BY business.review_count DESC LIMIT 3;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the latitude and longitude of the business with the highest rating?,"SELECT business.latitude, business.longitude FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id, business.latitude, business.longitude ORDER BY AVG(review.rating) DESC LIMIT 1;",yelp,order_by,,postgres,"SELECT business.latitude, business.longitude FROM business
JOIN review ON business.business_id = review.business_id
GROUP BY business.business_id
ORDER BY AVG(review.rating) DESC
LIMIT 1;",,"QUERY EXECUTION ERROR: (psycopg2.errors.GroupingError) column ""business.latitude"" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: SELECT business.latitude, business.longitude FROM business
               ^

[SQL: SELECT business.latitude, business.longitude FROM business
JOIN review ON business.business_id = review.business_id
GROUP BY business.business_id
ORDER BY AVG(review.rating) DESC
LIMIT 1;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
"How does the ratio of positive reviews (rating > 3) to negative reviews (rating < 3) vary across different categories of businesses, ordered by descending ratio?","SELECT {category.category_name, category.id}, CAST(COUNT(CASE WHEN review.rating > 3 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN review.rating < 3 THEN 1 END), 0) AS ratio FROM review JOIN category ON review.business_id = category.business_id GROUP BY {} ORDER BY ratio DESC NULLS LAST;",yelp,ratio,,postgres,"SELECT c.category_name, CAST(COUNT(CASE WHEN r.rating > 3 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN r.rating < 3 THEN 1 END), 0) AS ratio
FROM business b
JOIN category c ON b.business_id = c.business_id
JOIN review r ON b.business_id = r.business_id
GROUP BY c.category_name
ORDER BY ratio DESC;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of businesses in the state of California to businesses in the state of New York?,"SELECT CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio FROM business;",yelp,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN business.state = 'CA' THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN business.state = 'NY' THEN 1 END), 0) AS ratio
FROM business;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the ratio of check-ins on weekends to check-ins on weekdays for the business named ""Mark's Bistro""?","SELECT CAST(SUM(CASE WHEN checkin.day IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN checkin.day NOT IN ('Saturday', 'Sunday') THEN checkin.count ELSE 0 END), 0) AS ratio FROM checkin JOIN business ON checkin.business_id = business.business_id WHERE business.name ILIKE '%Mark''s Bistro%';",yelp,ratio,,postgres,"SELECT 
  CASE 
    WHEN to_date(c.day, 'Day') IN ('Saturday', 'Sunday') THEN 'Weekend'
    ELSE 'Weekday'
  END AS day_type, 
  COUNT(*) FILTER (WHERE c.business_id = 'Mark''s Bistro') AS checkin_count, 
  COUNT(*) FILTER (WHERE c.business_id!= 'Mark''s Bistro') AS not_checkin_count, 
  COUNT(*) FILTER (WHERE c_b.business_id = 'Mark''s Bistro') AS total_count
FROM 
  checkin c
JOIN 
  business c_b ON c.business_id = c_b.business_id
WHERE 
  c.business_id = 'Mark''s Bistro'
GROUP BY 
  day_type;",,"QUERY EXECUTION ERROR: (psycopg2.errors.InvalidDatetimeFormat) invalid input syntax for type date: ""Saturday""
LINE 3:     WHEN to_date(c.day, 'Day') IN ('Saturday', 'Sunday') THE...
                                           ^

[SQL: SELECT 
  CASE 
    WHEN to_date(c.day, 'Day') IN ('Saturday', 'Sunday') THEN 'Weekend'
    ELSE 'Weekday'
  END AS day_type, 
  COUNT(*) FILTER (WHERE c.business_id = 'Mark''s Bistro') AS checkin_count, 
  COUNT(*) FILTER (WHERE c.business_id!= 'Mark''s Bistro') AS not_checkin_count, 
  COUNT(*) FILTER (WHERE c_b.business_id = 'Mark''s Bistro') AS total_count
FROM 
  checkin c
JOIN 
  business c_b ON c.business_id = c_b.business_id
WHERE 
  c.business_id = 'Mark''s Bistro'
GROUP BY 
  day_type;]
(Background on this error at: https://sqlalche.me/e/20/9h9h)",0,0,0,1,0,,0,,,,,,,,,,,False
What is the ratio of open businesses to closed businesses in the city of San Francisco?,"SELECT CAST(SUM(CASE WHEN business.is_open = 1 THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(SUM(CASE WHEN business.is_open = 0 THEN 1 ELSE 0 END), 0) AS ratio FROM business WHERE LOWER(business.city) ILIKE '%san francisco%';",yelp,ratio,,postgres,"SELECT CAST(COUNT(CASE WHEN business.is_open = 1 THEN 1 END) AS FLOAT) / NULLIF(COUNT(CASE WHEN business.is_open = 0 THEN 1 END), 0) AS ratio
FROM business
WHERE business.city  =  'San Francisco';",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the ratio of the number of businesses in each state to the total number of businesses in the database?,"SELECT business.state, COUNT(business.business_id) / NULLIF(CAST((SELECT COUNT(*) FROM business) AS FLOAT), 0) AS ratio FROM business GROUP BY business.state;",yelp,ratio,,postgres,"SELECT business.state, COUNT(business.business_id) / NULLIF(CAST((SELECT COUNT(*) FROM business) AS FLOAT), 0) AS ratio
FROM business
GROUP BY business.state;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What are the top 2 categories of businesses with the highest average rating?,"SELECT {category.category_name, category.id} FROM (SELECT business.business_id, AVG(review.rating) AS average_rating FROM business JOIN review ON business.business_id = review.business_id GROUP BY business.business_id) AS business_rating JOIN category ON business_rating.business_id = category.business_id GROUP BY {} ORDER BY AVG(business_rating.average_rating) DESC NULLS LAST LIMIT 2;",yelp,table_join,,postgres,"SELECT c.category_name, avg(r.rating) AS average_rating FROM business AS b JOIN category AS c ON b.business_id = c.business_id JOIN review AS r ON b.business_id = r.business_id GROUP BY c.category_name ORDER BY average_rating DESC LIMIT 2;",,,0,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of check-ins for each business in the state of California?,"SELECT {business.business_id, business.name, business.bid}, SUM(checkin.count) AS total_checkins FROM business JOIN checkin ON business.business_id = checkin.business_id WHERE business.state = 'CA' GROUP BY {} ORDER BY total_checkins DESC NULLS LAST;",yelp,table_join,,postgres,"SELECT business.business_id, business.name, SUM(checkin.count) AS total_checkins
FROM business
JOIN checkin ON business.business_id = checkin.business_id
WHERE business.state = 'CA'
GROUP BY business.business_id, business.name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
What is the total number of reviews for each business category?,"SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;",yelp,table_join,,postgres,"SELECT c.category_name, COUNT(r.business_id) AS total_reviews
FROM review r
JOIN category c ON r.business_id = c.business_id
GROUP BY c.category_name;",,,1,1,0,0,0,,0,,,,,,,,,,,False
"What is the total number of reviews for each category in the state of ""California""?","SELECT {category.category_name, category.id}, SUM(business.review_count) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id WHERE business.state = 'CA' GROUP BY {} ORDER BY total_reviews DESC NULLS LAST;",yelp,table_join,,postgres,"SELECT category.category_name, COUNT(DISTINCT category.id) AS total_reviews FROM business JOIN category ON business.business_id = category.business_id WHERE business.state = 'CA' GROUP BY category.category_name;",,,0,0,0,0,0,,0,,,,,,,,,,,False
"Which users have posted reviews for businesses located in the neighbourhood of ""Downtown"" and how many reviews have they posted?","SELECT {users.name, users.user_id}, COUNT(review.rid) AS review_count FROM review JOIN neighbourhood ON review.business_id = neighbourhood.business_id JOIN users ON review.user_id = users.user_id WHERE neighbourhood.neighbourhood_name ILIKE '%Downtown%' GROUP BY {} ORDER BY review_count DESC NULLS LAST;",yelp,table_join,,postgres,"SELECT T1.user_id, COUNT(*) AS review_count FROM review AS T1 JOIN neighbourhood AS T2 ON T1.business_id  =  T2.business_id WHERE T2.neighbourhood_name  =  ""Downtown"" GROUP BY T1.user_id;",,"QUERY EXECUTION ERROR: (psycopg2.errors.UndefinedColumn) column ""Downtown"" does not exist
LINE 1: ...=  T2.business_id WHERE T2.neighbourhood_name  =  ""Downtown""...
                                                             ^

[SQL: SELECT T1.user_id, COUNT(*) AS review_count FROM review AS T1 JOIN neighbourhood AS T2 ON T1.business_id  =  T2.business_id WHERE T2.neighbourhood_name  =  ""Downtown"" GROUP BY T1.user_id;]
(Background on this error at: https://sqlalche.me/e/20/f405)",0,0,0,1,0,,0,,,,,,,,,,,False
